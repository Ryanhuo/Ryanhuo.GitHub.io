<!doctype html>
<html class="no-js" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="Shortcut Icon" href="asset/css/huo.ico" type="image/x-icon">
    <title>
    
  商铺数据加载及存储 - Ryanhuo
  
  </title>
  
  
  <link href="atom.xml" rel="alternate" title="Ryanhuo" type="application/atom+xml">
    <link rel="stylesheet" href="asset/css/foundation.css" />
    <link rel="stylesheet" href="asset/css/docs.css" />
    <script src="asset/js/vendor/modernizr.js"></script>
    <script src="asset/js/vendor/jquery.js"></script>
 
<script type="text/javascript">
  function before_search(){
    var searchVal = 'site:ryanhuo.github.io ' + document.getElementById('search_input').value;
    document.getElementById('search_q').value = searchVal;
    return true;
  }

</script>

  </head>
  <body class="antialiased hide-extras">
    
    <div class="marketing off-canvas-wrap" data-offcanvas>
      <div class="inner-wrap">


<nav class="top-bar docs-bar hide-for-small" data-topbar>


  <section class="top-bar-section">
  <div class="row">
      <div style="position: relative;width:100%;"><div style="position: absolute; width:100%;">
        <ul id="main-menu" class="left">
        
        <li id=""><a target="_self" href="index.html">主页</a></li>
        
        <li id=""><a target="_self" href="archives.html">目录</a></li>
        
        </ul>

        <ul class="right" id="search-wrap">
          <li>
 <!--<form target="_blank" onsubmit="return before_search();" action="https://google.com/search" method="get">
    <input type="hidden" id="search_q" name="q" value="" />
    <input tabindex="1" type="search" id="search_input"  placeholder="Search"/>
</form>-->
</li>
          </ul>
      </div></div>
  </div>
  </section>

</nav>

        <nav class="tab-bar show-for-small">
  <a href="javascript:void(0)" class="left-off-canvas-toggle menu-icon">
    <span> &nbsp; Ryanhuo</span>
  </a>
</nav>


<section id="header">
  <div class="inner">
    <span class="icon major fa-cloud"></span>
    <img src="asset/img/火.png" alt="logo">
    <h1>Hi, I'm <strong>Ryan</strong><br /></h1>
    <p><a href="ryanhuo.github.io">我的主页</a></p>
    <p>我是黑暗里中大雪纷飞的人哪，<br />
    你再不来，我要下雪来</p>
    <ul class="actions">
      <li><a href="rfile:///Users/ryan/Library/Containers/com.coderforart.MWeb3/Data/Documents/themes/Site/Ryanhuo.GitHub.io/jian-lixing-ming-lei-yanqiu-zh.html" class="button scrolly">About Me</a></li>
    </ul>
  </div>
</section>


<aside class="left-off-canvas-menu">
      <ul class="off-canvas-list">
        
        <li><a target="_self" href="index.html">主页</a></li>
        
        <li><a target="_self" href="archives.html">目录</a></li>
        

    <li><label>Categories</label></li>

        
            <li><a href="%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90.html">数据分析</a></li>
        
            <li><a href="ML&DL.html">ML&DL</a></li>
         

      </ul>
    </aside>

<a class="exit-off-canvas" href="#"></a>


        <section id="main-content" role="main" class="scroll-container">
        
       

 <script type="text/javascript">
  $(function(){
    $('#menu_item_index').addClass('is_active');
  });
</script>
<div class="row">
  <div class="large-8 medium-8 columns">
      <div class="markdown-body article-wrap">
       <div class="article">
          
          <h1>商铺数据加载及存储</h1>
     
        <div class="read-more clearfix">
          <span class="date">2020/02/21</span>

          <span>posted in&nbsp;</span> 
          
              <span class="posted-in"><a href='%E9%A1%B9%E7%9B%AE.html'>项目</a></span>
           
         
          <span class="comments">
            

            
          </span>

        </div>
      </div><!-- article -->

      <div class="article-content">
      <p><a href="media/15822327224405/%E5%95%86%E9%93%BA%E6%95%B0%E6%8D%AE.csv">商铺数据</a></p>

<p><img src="media/15822327224405/2019-11-03-133518.png" alt=""/></p>

<blockquote>
<p><strong>要求:</strong></p>

<ol>
<li>成功读取“商铺数据.csv”文件</li>
<li>解析数据，存为list</li>
<li><p>数据清洗：</p>
<ul>
<li>comment，price两个字段清洗成数字</li>
<li>清除字段缺失的数据</li>
<li>commentlist拆分成三个字段，并且清洗成数字</li>
</ul></li>
<li><p>结果存为.csv文件</p></li>
</ol>
</blockquote>

<pre><code class="language-python"># 1.导入数据
f=open(&#39;商铺数据.csv&#39;,&#39;r&#39;,encoding=&#39;utf-8&#39;)
#查看前6行数据函数
def data(x):
    if x==all:
        for line in f.readlines()[:6] :#查看前5行数据
            print(line.split(&#39;,&#39;))# 按,拆分
    else:
        for line in f.readlines()[:6] :
            print(line.split(&#39;,&#39;)[x])
    f.seek(0,0)
data(all)
</code></pre>

<pre><code class="language-text">[&#39;\ufeffclassify&#39;, &#39;name&#39;, &#39;comment&#39;, &#39;star&#39;, &#39;price&#39;, &#39;address&#39;, &#39;commentlist\n&#39;]
[&#39;美食&#39;, &#39;望蓉城老坛酸菜鱼(合生汇店)&#39;, &#39;我要点评&#39;, &#39;该商户暂无星级&#39;, &#39;人均                                        ￥125&#39;, &#39;翔殷路1099号合生汇5F&#39;, &#39;口味8.3                                环境8.4                                服务8.5\n&#39;]
[&#39;美食&#39;, &#39;泰国街边料理&#39;, &#39;74                    条点评&#39;, &#39;准四星商户&#39;, &#39;人均                                        ￥48&#39;, &#39;黄兴路合生汇B2美食集市内&#39;, &#39;口味7.4                                环境7.6                                服务7.4\n&#39;]
[&#39;美食&#39;, &#39;壹面如故(苏宁生活广场店)&#39;, &#39;265                    条点评&#39;, &#39;准四星商户&#39;, &#39;人均                                        ￥21&#39;, &#39;邯郸路585号苏宁生活广场B1层&#39;, &#39;口味7.0                                环境7.2                                服务7.2\n&#39;]
[&#39;美食&#39;, &#39;鮨谷•Aburiya(合生汇店)&#39;, &#39;2748                    条点评&#39;, &#39;准五星商户&#39;, &#39;人均                                        ￥142&#39;, &#39;翔殷路1099号合生广场5楼23、28铺位&#39;, &#39;口味8.9                                环境8.5                                服务8.4\n&#39;]
[&#39;美食&#39;, &#39;我们的烤肉我们的馕&#39;, &#39;5                    条点评&#39;, &#39;准四星商户&#39;, &#39;人均                                    -&#39;, &#39;邯郸路399-D3号&#39;, &#39;口味7.5                                环境6.8                                服务7.5\n&#39;]
</code></pre>

<h2 id="toc_0">清洗数据</h2>

<p><a href="%E9%99%84%E4%BB%B6%E5%95%86%E9%93%BA%E6%95%B0%E6%8D%AE.csv">商铺数据.csv</a> </p>

<h3 id="toc_1">清洗评论数量数据</h3>

<pre><code class="language-python">f.seek(0,0)
print(&#39;---原始数据预览---&#39;)
data(2)#查看评论数据

#定义清洗数据函数
import re

def comment_number(s):
    if &#39;我要点评&#39; in s:
        return &#39;无数据&#39;
    else:
        return re.findall(r&#39;\d+&#39;,s)

print(&#39;---清洗完数据预览---&#39;)

for line in f.readlines()[:6] :
        cm_n=comment_number(line.split(&#39;,&#39;)[2])
        print(cm_n)
</code></pre>

<pre><code class="language-text">---原始数据预览---
comment
我要点评
74                    条点评
265                    条点评
2748                    条点评
5                    条点评
---清洗完数据预览---
[]
无数据
[&#39;74&#39;]
[&#39;265&#39;]
[&#39;2748&#39;]
[&#39;5&#39;]
</code></pre>

<h3 id="toc_2">清洗价格数据</h3>

<pre><code class="language-python">f.seek(0,0)

print(&#39;---原始数据预览---&#39;)
data(4)

def pri(s):
    if &#39;-&#39; in s:
        return &#39;无数据&#39;
    else:
        return re.findall(r&#39;\d+&#39;,s)

print(&#39;---清洗完数据预览---&#39;)

for line in f.readlines()[:6] :
        pr=pri(line.split(&#39;,&#39;)[4])
        print(pr)
</code></pre>

<pre><code class="language-text">---原始数据预览---
price
人均                                        ￥125
人均                                        ￥48
人均                                        ￥21
人均                                        ￥142
人均                                    -
---清洗完数据预览---
[]
[&#39;125&#39;]
[&#39;48&#39;]
[&#39;21&#39;]
[&#39;142&#39;]
无数据
</code></pre>

<h3 id="toc_3">清洗评论数据</h3>

<pre><code class="language-python">f.seek(0,0)

print(&#39;---原始数据预览---&#39;)
data(-1)

def comment(s):
    if len(s)&lt;3:
        return &#39;无数据&#39;
    else:
        return re.findall(r&#39;\d+\.\d&#39;,s)#提取小数


print(&#39;---清洗完数据预览---&#39;)

for line in f.readlines()[:6] :
        cm=comment(line.split(&#39;,&#39;)[-1])
        print(cm)
</code></pre>

<pre><code class="language-text">---原始数据预览---
commentlist

口味8.3                                环境8.4                                服务8.5

口味7.4                                环境7.6                                服务7.4

口味7.0                                环境7.2                                服务7.2

口味8.9                                环境8.5                                服务8.4

口味7.5                                环境6.8                                服务7.5

---清洗完数据预览---
[]
[&#39;8.3&#39;, &#39;8.4&#39;, &#39;8.5&#39;]
[&#39;7.4&#39;, &#39;7.6&#39;, &#39;7.4&#39;]
[&#39;7.0&#39;, &#39;7.2&#39;, &#39;7.2&#39;]
[&#39;8.9&#39;, &#39;8.5&#39;, &#39;8.4&#39;]
[&#39;7.5&#39;, &#39;6.8&#39;, &#39;7.5&#39;]
</code></pre>

<h3 id="toc_4">汇总数据</h3>

<pre><code class="language-python">#数据清洗
import csv
csvfile=open(&#39;清洗完数据.csv&#39;,&#39;w&#39;)
writer = csv.writer(csvfile)
writer.writerow([&#39;classify&#39;,&#39;name&#39;,&#39;comment&#39;,&#39;star&#39;,&#39;price&#39;,&#39;address&#39;,&#39;quality&#39;,&#39;environment&#39;,&#39;service&#39;])

f.seek(0,0)

for line in f.readlines()[1:10] :#删除第一个数据
    s=line.split(&#39;,&#39;)   
    classify=s[0]
    name=s[1]
    comment_1=comment_number(s[2])[0]#获取列表下数字
    star=s[3]
    price=pri(s[4])[0]
    address=s[5]
    quality=comment(s[-1])[0]
    environment=comment(s[-1])[1]
    service=comment(s[-1])[2]
#预览查看    
    print(classify,name,comment_1,star,price,address,quality,environment,service)
    
#删除缺失数据   
    if &#39;无数据&#39;not in [classify,name,comment_1,star,price,address,quality,environment,service]:
        writer.writerow([classify,name,comment_1,star,price,address,quality,environment,service])
        
csvfile.close()
f.close()
</code></pre>

<pre><code class="language-text">美食 望蓉城老坛酸菜鱼(合生汇店) 无 该商户暂无星级 125 翔殷路1099号合生汇5F 8.3 8.4 8.5
美食 泰国街边料理 74 准四星商户 48 黄兴路合生汇B2美食集市内 7.4 7.6 7.4
美食 壹面如故(苏宁生活广场店) 265 准四星商户 21 邯郸路585号苏宁生活广场B1层 7.0 7.2 7.2
美食 鮨谷•Aburiya(合生汇店) 2748 准五星商户 142 翔殷路1099号合生广场5楼23、28铺位 8.9 8.5 8.4
美食 我们的烤肉我们的馕 5 准四星商户 无 邯郸路399-D3号 7.5 6.8 7.5
美食 麦当劳(万达店) 785 准四星商户 24 邯郸路600号万达商业广场B1楼A05号铺 7.4 7.2 7.2
美食 蒸年青STEAMYOUNG(百联又一城购物中心店) 3779 准五星商户 70 淞沪路8号百联又一城购物中心7层 8.6 8.6 8.6
美食 丸来玩趣(百联又一城购物中心店) 458 准四星商户 14 淞沪路8号百联又一城购物中心B1层 7.0 6.5 6.5
美食 韩国雪冰(合生汇店) 1280 四星商户 47 翔殷路1099号合生汇4F 7.7 7.5 7.6
</code></pre>

<h2 id="toc_5">代码汇总</h2>

<pre><code class="language-python"># 1.导入数据
f=open(&#39;商铺数据.csv&#39;,&#39;r&#39;,encoding=&#39;utf-8&#39;)
#2. 定义函数
import re

def comment_number(s):
    if &#39;我要点评&#39; in s:
        return &#39;无数据&#39;
    else:
        return re.findall(r&#39;\d+&#39;,s)
    
def pri(s):
    if &#39;-&#39; in s:
        return &#39;无数据&#39;
    else:
        return re.findall(r&#39;\d+&#39;,s)
    
def comment(s):
    if len(s)&lt;3:
        return &#39;无数据&#39;
    else:
        return re.findall(r&#39;\d+\.\d&#39;,s)#提取小数
    
# 3.计算清洗数据&amp;导出csv

import csv
csvfile=open(&#39;清洗完数据.csv&#39;,&#39;w&#39;)
writer = csv.writer(csvfile)
writer.writerow([&#39;classify&#39;,&#39;name&#39;,&#39;comment&#39;,&#39;star&#39;,&#39;price&#39;,&#39;address&#39;,&#39;quality&#39;,&#39;environment&#39;,&#39;service&#39;])

f.seek(0,0)
n=0 #计数变量
for line in f.readlines()[1:] :#删除第一个数据
    s=line.split(&#39;,&#39;)   
    classify=s[0]
    name=s[1]
    comment_1=comment_number(s[2])[0]#获取列表下数字
    star=s[3]
    price=pri(s[4])[0]
    address=s[5]
    quality=comment(s[-1])[0]
    environment=comment(s[-1])[1]
    service=comment(s[-1])[2]
    
#删除缺失数据   
    if &#39;无数据&#39;not in [classify,name,comment_1,star,price,address,quality,environment,service]:
        n+=1
        writer.writerow([classify,name,comment_1,star,price,address,quality,environment,service])
        
print(&#39;导出成功，合计&#39;+str(n)+&#39;条数据&#39;)
csvfile.close()
f.close()
</code></pre>

<pre><code class="language-text">导出成功，合计1265条数据
</code></pre>

<p><img src="media/15822327224405/2019-11-03-133621.png" alt=""/></p>

<p><a href="media/15822327224405/%E6%B8%85%E6%B4%97%E5%AE%8C%E6%95%B0%E6%8D%AE.csv">清洗完数据</a></p>


    

      </div>

      <div class="row">
        <div class="large-6 columns">
        <p class="text-left" style="padding:15px 0px;">
      
          <a href="15822327224310.html" 
          title="Previous Post: 厦门市集美区租房分析">&laquo; 厦门市集美区租房分析</a>
      
        </p>
        </div>
        <div class="large-6 columns">
      <p class="text-right" style="padding:15px 0px;">
      
          <a  href="15822327224453.html" 
          title="Next Post: 当当图书爬虫">当当图书爬虫 &raquo;</a>
      
      </p>
        </div>
      </div>
      <div class="comments-wrap">
        <div class="share-comments">
          

          

          
        </div>
      </div>
    </div><!-- article-wrap -->
  </div><!-- large 8 -->




 <div class="large-4 medium-4 columns">
  <div class="hide-for-small">
    <div id="sidebar" class="sidebar">
      

             

              <div id="site-categories" class="side-item ">
                <div class="side-header">
                  <h2>分类目录</h2>
                </div>
                <div class="side-content">

      	<p class="cat-list">
        
            <a href="%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90.html"><strong>数据分析</strong></a>
        
            <a href="ML&DL.html"><strong>ML&DL</strong></a>
         
        </p>


                </div>
              </div>

              <div id="site-categories" class="side-item">
                <div class="side-header">
                  <h2>最近文章</h2>
                </div>
                <div class="side-content">
                <ul class="posts-list">
	      
		      
			      <li class="post">
			        <a href="15822402376673.html">2.2 补充梯度下降理解</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15822402376778.html">1.1 机器学习</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15822394457187.html">淘宝用户行为分析</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15822375587081.html">4. excel常见函数</a>
			      </li>
		     
		  
		      
			      <li class="post">
			        <a href="15822373698224.html">1. 认识excel</a>
			      </li>
		     
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		  
		      
		   
		  		</ul>
                </div>
              </div>

              <div id="site-categories" class="side-item">
              <div class="side-header">
                <h2>联系我</h2>
              </div>
            </div>

            <div id="site-info" class="site-info">
              
               
                <!--
                     <h1>Ryanhuo</h1> 
                     <div class="site-des">My Blog 2.0</div>-->
                <div class="social">
     
     
     
     
     
     
     
     
     
     <a target="_blank" class="github" target="_blank" href="https://github.com/Ryanhuo" title="GitHub">GitHub</a>
     <a target="_blank" class="email" href="mailto:ryan97916@outlook.com" title="Email">Email</a>
       <a target="_blank" class="rss" href="atom.xml" title="RSS">RSS</a>
       
      </div>
       <div class="social">  
                <img src="asset/img/公众号.jpg" alt="公众号二维码">
              </div>
              </div>

            
        </div><!-- sidebar -->
      </div><!-- hide for small -->
</div><!-- large 4 -->

</div><!-- row -->

 <div class="page-bottom clearfix">
  <div class="row">
   <p class="copyright">Copyright &copy; 2020
Powered by <a target="_blank" href="http://ryanhuo.github.io">Ryan</a>,&nbsp; 
Theme used <a target="_blank" href="http://github.com">GitHub CSS</a>.</p>
  </div>
</div>

        </section>
      </div>
    </div>



  













<script src="asset/prism.js"></script>


<style type="text/css">
figure{margin: 0;padding: 0;}
figcaption{text-align:center;}

/* PrismJS 1.14.0
 http://prismjs.com/download.html#themes=prism&languages=markup+css+clike+javascript */
/**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
    color: black;
    background: none;
    text-shadow: 0 1px white;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;
    
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
    
    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
    text-shadow: none;
    background:#b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
    text-shadow: none;
    background: #b3d4fc;
}

@media print {
    code[class*="language-"],
    pre[class*="language-"] {
        text-shadow: none;
    }
}

/* Code blocks */
pre[class*="language-"] {
    padding: 1em;
    margin: .5em 0;
    overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
    background: #F7F7F7;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
    padding: .1em;
    border-radius: .3em;
    white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
    color: slategray;
}

.token.punctuation {
    color: #999;
}

.namespace {
    opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
    color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
    color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
    color: #9a6e3a;
    background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
    color: #07a;
}

.token.function,
.token.class-name {
    color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
    color: #e90;
}

.token.important,
.token.bold {
    font-weight: bold;
}
.token.italic {
    font-style: italic;
}

.token.entity {
    cursor: help;
}


pre[class*="language-"].line-numbers {
    position: relative;
    padding-left: 3.8em;
    counter-reset: linenumber;
}

pre[class*="language-"].line-numbers > code {
    position: relative;
    white-space: inherit;
}

.line-numbers .line-numbers-rows {
    position: absolute;
    pointer-events: none;
    top: 0;
    font-size: 100%;
    left: -3.8em;
    width: 3em; /* works for line-numbers below 1000 lines */
    letter-spacing: -1px;
    border-right: 1px solid #999;

    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;

}

    .line-numbers-rows > span {
        pointer-events: none;
        display: block;
        counter-increment: linenumber;
    }

        .line-numbers-rows > span:before {
            content: counter(linenumber);
            color: #999;
            display: block;
            padding-right: 0.8em;
            text-align: right;
        }

</style>

  
    

    <script src="asset/js/foundation.min.js"></script>
    <script>
      $(document).foundation();
      function fixSidebarHeight(){
        var w1 = $('.markdown-body').height();
          var w2 = $('#sidebar').height();
          if (w1 > w2) { $('#sidebar').height(w1); };
      }
      $(function(){
        fixSidebarHeight();
      })
      $(window).load(function(){
          fixSidebarHeight();
      });
     
    </script>



  </body>
</html>
