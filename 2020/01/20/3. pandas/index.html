<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
    
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
    3. pandas |  Ryan
  </title>
  <meta name="generator" content="hexo-theme-yilia-plus">
  
  <link rel="shortcut icon" href="/huo.ico" />
  
  
<link rel="stylesheet" href="/css/style.css">

  
<script src="/js/pace.min.js"></script>


  

  

</head>

</html>

<body>
  <div id="app">
    <main class="content">
      <section class="outer">
  <article id="post-3. pandas" class="article article-type-post" itemscope
  itemprop="blogPost" data-scroll-reveal>

  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  3. pandas
</h1>
  

    </header>
    

    
    <div class="article-meta">
      <a href="/2020/01/20/3.%20pandas/" class="article-date">
  <time datetime="2020-01-20T07:29:03.675Z" itemprop="datePublished">2020-01-20</time>
</a>
      
  <div class="article-category">
    <a class="article-category-link" href="/categories/data-analytics/">data analytics</a>
  </div>

      
      
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> 字数统计:</span>
            <span class="post-count">14.8k字</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> 阅读时长≈</span>
            <span class="post-count">80分钟</span>
        </span>
    </span>
</div>

      
    </div>
    

    
    
    <div class="tocbot"></div>





    

    <div class="article-entry" itemprop="articleBody">
      


      

      
      <h2 id="Pandas简介"><a href="#Pandas简介" class="headerlink" title="Pandas简介"></a>Pandas简介</h2><p>Pandas 是基于NumPy 的一种工具，该工具是为了解决数据分析任务而创建的。Pandas 纳入了大量库和一些标准的数据模型，提供了高效地操作大型数据集所需的工具。pandas提供了大量能使我们快速便捷地处理数据的函数和方法。</p>
<h2 id="Series对象"><a href="#Series对象" class="headerlink" title="Series对象"></a>Series对象</h2><p>Pandas基于两种数据类型：series与dataframe。</p>
<p>Series是Pandas中最基本的对象，Series类似一种一维数组。事实上，Series 基本上就是基于 NumPy 的数组对象来的。和 NumPy 的数组不同，Series 能为数据自定义标签，也就是索引（index），然后通过索引来访问数组中的数据。</p>
<p>Dataframe是一个二维的表结构。Pandas的dataframe可以存储许多种不同的数据类型，并且每一个坐标轴都有自己的标签。你可以把它想象成一个series的字典项。</p>
<a id="more"></a>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series,DataFrame</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br></pre></td></tr></table></figure>

<h3 id="创建series"><a href="#创建series" class="headerlink" title="创建series"></a>创建series</h3><p>index 参数是可省略的，你可以选择不输入这个参数。<br>如果不带 index 参数，Pandas 会自动用默认 index 进行索引，类似数组，索引值是 [0, …, len(data) - 1]</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sel=Series([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>])</span><br><span class="line">print(sel)</span><br></pre></td></tr></table></figure>

<pre><code>0    1
1    2
2    3
3    4
dtype: int64</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#通常创建方式</span></span><br><span class="line">sel=Series([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>],index=[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>])</span><br><span class="line"><span class="comment">#sel=Series([1,2,3,4],index=list('abcd'))</span></span><br><span class="line">print(sel)</span><br></pre></td></tr></table></figure>

<pre><code>a    1
b    2
c    3
d    4
dtype: int64</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(sel.values) <span class="comment">#获取索引值</span></span><br><span class="line">print(sel.index) <span class="comment">#获取检索值</span></span><br><span class="line">print(sel.iteritems()) <span class="comment">#获取索引和值对</span></span><br></pre></td></tr></table></figure>

<pre><code>[1 2 3 4]
Index([&apos;a&apos;, &apos;b&apos;, &apos;c&apos;, &apos;d&apos;], dtype=&apos;object&apos;)
&lt;zip object at 0x00000000085838C8&gt;</code></pre><h4 id="字典转化为Series"><a href="#字典转化为Series" class="headerlink" title="字典转化为Series"></a>字典转化为Series</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dict=&#123;<span class="string">"red"</span>:<span class="number">100</span>,<span class="string">"black"</span>:<span class="number">400</span>,<span class="string">"green"</span>:<span class="number">300</span>,<span class="string">"pink"</span>:<span class="number">900</span>&#125;</span><br><span class="line">se3=Series(dict) </span><br><span class="line">print(se3)</span><br></pre></td></tr></table></figure>

<pre><code>red      100
black    400
green    300
pink     900
dtype: int64</code></pre><h4 id="Series数据获取"><a href="#Series数据获取" class="headerlink" title="Series数据获取"></a>Series数据获取</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Series对象同时支持位置和标签两种方式获取数据</span></span><br><span class="line">print(<span class="string">'索引下标'</span>,sel[<span class="string">'c'</span>])</span><br><span class="line">print(<span class="string">'位置下标'</span>,sel[<span class="number">2</span>])</span><br></pre></td></tr></table></figure>

<pre><code>索引下标 3
位置下标 3</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#获取不连续的数据</span></span><br><span class="line">print(<span class="string">'索引下标'</span>,sel[[<span class="string">'a'</span>,<span class="string">'c'</span>]])</span><br><span class="line">print(<span class="string">'位置下标'</span>,sel[[<span class="number">1</span>,<span class="number">3</span>]])</span><br></pre></td></tr></table></figure>

<pre><code>索引下标 a    1
c    3
dtype: int64
位置下标 b    2
d    4
dtype: int64</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#可以使用切片获取数据</span></span><br><span class="line">print(<span class="string">'索引下标'</span>,sel[<span class="string">'a'</span>:<span class="string">'c'</span>])</span><br><span class="line">print(<span class="string">'位置下标'</span>,sel[<span class="number">0</span>:<span class="number">3</span>])</span><br></pre></td></tr></table></figure>

<pre><code>索引下标 a    1
b    2
c    3
dtype: int64
位置下标 a    1
b    2
c    3
dtype: int64</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#重新赋值索引值</span></span><br><span class="line">sel.index=[<span class="string">'d'</span>,<span class="string">'f'</span>,<span class="string">'h'</span>,<span class="string">'g'</span>]</span><br><span class="line">print(sel)</span><br></pre></td></tr></table></figure>

<pre><code>d    1
f    2
h    3
g    4
dtype: int64</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#ReIndex重新索引,会返回一个新的Series(调用reindex将会重新排序，缺失值则用NaN填补) </span></span><br><span class="line">print(sel.reindex([<span class="string">'b'</span>,<span class="string">'a'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'e'</span>]))</span><br><span class="line">print(sel)</span><br></pre></td></tr></table></figure>

<pre><code>b    NaN
a    NaN
c    NaN
d    1.0
e    NaN
dtype: float64
d    1
f    2
h    3
g    4
dtype: int64</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Drop丢弃指定轴的项</span></span><br><span class="line">se1=pd.Series(range(<span class="number">10</span>,<span class="number">15</span>)) </span><br><span class="line">print(se1) </span><br><span class="line">print(se1.drop([<span class="number">2</span>,<span class="number">3</span>]))</span><br></pre></td></tr></table></figure>

<pre><code>0    10
1    11
2    12
3    13
4    14
dtype: int64
0    10
1    11
4    14
dtype: int64</code></pre><h3 id="Series-进行算术运算操作"><a href="#Series-进行算术运算操作" class="headerlink" title="Series 进行算术运算操作"></a>Series 进行算术运算操作</h3><p>对 Series 的算术运算都是基于 index 进行的。</p>
<p>我们可以用加减乘除（+ - * /）这样的运算符对两个 Series 进行运算，</p>
<p>Pandas 将会根据索引 index，对响应的数据进行计算，结果将会以浮点数的形式存储，以避免丢失精度。</p>
<p>如果 Pandas 在两个 Series 里找不到相同的 index，对应的位置就返回一个空值 NaN</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">series1 = pd.Series([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>],[<span class="string">'London'</span>,<span class="string">'HongKong'</span>,<span class="string">'Humbai'</span>,<span class="string">'lagos'</span>])</span><br><span class="line">series2 = pd.Series([<span class="number">1</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">4</span>],[<span class="string">'London'</span>,<span class="string">'Accra'</span>,<span class="string">'lagos'</span>,<span class="string">'Delhi'</span>])</span><br></pre></td></tr></table></figure>


<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">print(series1+series2)</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line">print(series1+series2)</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line">print(series1*series2)</span><br></pre></td></tr></table></figure>

<pre><code>Accra        NaN
Delhi        NaN
HongKong     NaN
Humbai       NaN
London       2.0
lagos       10.0
dtype: float64
--------------------
Accra        NaN
Delhi        NaN
HongKong     NaN
Humbai       NaN
London       2.0
lagos       10.0
dtype: float64
--------------------
Accra        NaN
Delhi        NaN
HongKong     NaN
Humbai       NaN
London       1.0
lagos       24.0
dtype: float64</code></pre><h4 id="series支持numpy数组运算"><a href="#series支持numpy数组运算" class="headerlink" title="series支持numpy数组运算"></a>series支持numpy数组运算</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sel =Series(data = [<span class="number">1</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">5</span>], index =[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>]) </span><br><span class="line">print(sel[sel&gt;<span class="number">3</span>])<span class="comment">#布尔数组过滤</span></span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line">print(sel*<span class="number">2</span>)</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line">print(np.square(sel))<span class="comment">#直接加入到numpy的数学函数</span></span><br></pre></td></tr></table></figure>

<pre><code>b    6
d    5
dtype: int64
--------------------
a     2
b    12
c     6
d    10
dtype: int64
--------------------
a     1
b    36
c     9
d    25
dtype: int64</code></pre><h2 id="DataFrame"><a href="#DataFrame" class="headerlink" title="DataFrame"></a>DataFrame</h2><p>DataFrame（数据表）是一种 2 维数据结构，数据以表格的形式存储，分成若干行和列。通过 DataFrame，你能很方便地处理数据。常见的操作比如选取、替换行或列的数据，还能重组数据表、修改索引、多重筛选等。我们基本上   可以把 DataFrame 理解成一组采用同样索引的 Series 的集合。调用DataFrame()可以将多种格式的数据转换为<br>DataFrame对象，它的的三个参数data、index和columns分别为数据、行索引和列索引。</p>
<h3 id="DataFrame的创建"><a href="#DataFrame的创建" class="headerlink" title="DataFrame的创建"></a>DataFrame的创建</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df1 = DataFrame(np.random.randint(<span class="number">0</span>,<span class="number">10</span>,(<span class="number">4</span>,<span class="number">4</span>)),index=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>],columns=[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>]) </span><br><span class="line">print(df1)</span><br></pre></td></tr></table></figure>

<pre><code>   a  b  c  d
1  9  3  7  2
2  8  8  4  3
3  5  5  7  0
4  4  0  7  2</code></pre><h4 id="字典创建"><a href="#字典创建" class="headerlink" title="字典创建"></a>字典创建</h4><p>行索引由index决定，列索引由字典的键决定</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dict=&#123;</span><br><span class="line"><span class="string">'Province'</span>: [<span class="string">'Guangdong'</span>, <span class="string">'Beijing'</span>, <span class="string">'Qinghai'</span>, <span class="string">'Fujian'</span>],</span><br><span class="line"><span class="string">'pop'</span>: [<span class="number">1.3</span>, <span class="number">2.5</span>, <span class="number">1.1</span>, <span class="number">0.7</span>],</span><br><span class="line"><span class="string">'year'</span>: [<span class="number">2018</span>, <span class="number">2018</span>, <span class="number">2018</span>, <span class="number">2018</span>]&#125;</span><br><span class="line">df2=pd.DataFrame(dict,index=[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]) </span><br><span class="line">print(df2)</span><br></pre></td></tr></table></figure>

<pre><code>    Province  pop  year
1  Guangdong  1.3  2018
2    Beijing  2.5  2018
3    Qinghai  1.1  2018
4     Fujian  0.7  2018</code></pre><h4 id="使用from-dict"><a href="#使用from-dict" class="headerlink" title="使用from_dict"></a>使用from_dict</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dict2=&#123;<span class="string">'a'</span>:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],<span class="string">'b'</span>:[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>]&#125;</span><br><span class="line">df3=pd.DataFrame.from_dict(dict2)</span><br><span class="line">print(df3)</span><br></pre></td></tr></table></figure>

<pre><code>   a  b
0  1  a
1  2  b
2  3  c</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#索引相同的情况下，相同索引的值会相对应，缺少的值会添加NaN </span></span><br><span class="line">data = &#123;</span><br><span class="line">    <span class="string">'Name'</span>:pd.Series([<span class="string">'zs'</span>,<span class="string">'ls'</span>,<span class="string">'we'</span>],index=[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>]),</span><br><span class="line">    <span class="string">'Age'</span>:pd.Series([<span class="string">'10'</span>,<span class="string">'20'</span>,<span class="string">'30'</span>,<span class="string">'40'</span>],index=[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>]),</span><br><span class="line">    <span class="string">'country'</span>:pd.Series([<span class="string">'中国'</span>,<span class="string">'日本'</span>,<span class="string">'韩国'</span>],index=[<span class="string">'a'</span>,<span class="string">'c'</span>,<span class="string">'b'</span>])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">df = pd.DataFrame(data) </span><br><span class="line">print(df)</span><br><span class="line"><span class="comment"># to_dict()方法将DataFrame对象转换为字典</span></span><br><span class="line">dict = df.to_dict()</span><br><span class="line">print(dict)</span><br></pre></td></tr></table></figure>

<pre><code>  Name Age country
a   zs  10      中国
b   ls  20      韩国
c   we  30      日本
d  NaN  40     NaN
{&apos;Name&apos;: {&apos;a&apos;: &apos;zs&apos;, &apos;b&apos;: &apos;ls&apos;, &apos;c&apos;: &apos;we&apos;, &apos;d&apos;: nan}, &apos;Age&apos;: {&apos;a&apos;: &apos;10&apos;, &apos;b&apos;: &apos;20&apos;, &apos;c&apos;: &apos;30&apos;, &apos;d&apos;: &apos;40&apos;}, &apos;country&apos;: {&apos;a&apos;: &apos;中国&apos;, &apos;b&apos;: &apos;韩国&apos;, &apos;c&apos;: &apos;日本&apos;, &apos;d&apos;: nan}}</code></pre><h3 id="DataFrame对象常用属性"><a href="#DataFrame对象常用属性" class="headerlink" title="DataFrame对象常用属性"></a>DataFrame对象常用属性</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series,DataFrame</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"><span class="comment">#数据</span></span><br><span class="line">df_dict = &#123;</span><br><span class="line">    <span class="string">'name'</span>:[<span class="string">'James'</span>,<span class="string">'Curry'</span>,<span class="string">'Iversion'</span>],</span><br><span class="line">    <span class="string">'age'</span>:[<span class="string">'18'</span>,<span class="string">'20'</span>,<span class="string">'19'</span>],</span><br><span class="line">    <span class="string">'national'</span>:[<span class="string">'us'</span>,<span class="string">'China'</span>,<span class="string">'us'</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">df=pd.DataFrame(df_dict,index=[<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>

<pre><code>       name age national
0     James  18       us
1     Curry  20    China
2  Iversion  19       us</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#获取行列数</span></span><br><span class="line">print(df.shape)</span><br></pre></td></tr></table></figure>

<pre><code>(3, 3)</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#获取行索引</span></span><br><span class="line">print(df.index.tolist())</span><br></pre></td></tr></table></figure>

<pre><code>[0, 1, 2]</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#获取列索引</span></span><br><span class="line">print(df.columns.tolist())</span><br></pre></td></tr></table></figure>

<pre><code>[&apos;name&apos;, &apos;age&apos;, &apos;national&apos;]</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#获取数据类型</span></span><br><span class="line">print(df.dtypes)</span><br></pre></td></tr></table></figure>

<pre><code>name        object
age         object
national    object
dtype: object</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#获取数据维度</span></span><br><span class="line">print(df.ndim)</span><br></pre></td></tr></table></figure>

<pre><code>2</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#values属性也会以二维ndarray的形式返回DataFrame的数据</span></span><br><span class="line">print(df.values)</span><br></pre></td></tr></table></figure>

<pre><code>[[&apos;James&apos; &apos;18&apos; &apos;us&apos;]
 [&apos;Curry&apos; &apos;20&apos; &apos;China&apos;]
 [&apos;Iversion&apos; &apos;19&apos; &apos;us&apos;]]</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#展示概况</span></span><br><span class="line">print(df.info())</span><br></pre></td></tr></table></figure>

<pre><code>&lt;class &apos;pandas.core.frame.DataFrame&apos;&gt;
Int64Index: 3 entries, 0 to 2
Data columns (total 3 columns):
name        3 non-null object
age         3 non-null object
national    3 non-null object
dtypes: object(3)
memory usage: 96.0+ bytes
None</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#显示头两行，默认头五行</span></span><br><span class="line">print(df.head(<span class="number">2</span>))</span><br></pre></td></tr></table></figure>

<pre><code>    name age national
0  James  18       us
1  Curry  20    China</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#显示后几行</span></span><br><span class="line">print(df.tail(<span class="number">2</span>))</span><br></pre></td></tr></table></figure>

<pre><code>       name age national
1     Curry  20    China
2  Iversion  19       us</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#获取DataFrame的列</span></span><br><span class="line">print(df[<span class="string">'name'</span>])</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment">#因为我们只获取一列，所以返回的就是一个 Series </span></span><br><span class="line">print(type(df[<span class="string">'name'</span>]))</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 如果获取多个列，那返回的就是一个 DataFrame 类型：</span></span><br><span class="line">print(df[[<span class="string">'name'</span>,<span class="string">'age'</span>]])</span><br><span class="line">print(type(df[[<span class="string">'name'</span>,<span class="string">'age'</span>]]))</span><br></pre></td></tr></table></figure>

<pre><code>0       James
1       Curry
2    Iversion
Name: name, dtype: object
--------------------
&lt;class &apos;pandas.core.series.Series&apos;&gt;
--------------------
       name age
0     James  18
1     Curry  20
2  Iversion  19
&lt;class &apos;pandas.core.frame.DataFrame&apos;&gt;</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取一行</span></span><br><span class="line">print(df[<span class="number">0</span>:<span class="number">1</span>])</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 获取多行</span></span><br><span class="line">print(df[<span class="number">1</span>:<span class="number">3</span>])</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 取多行里面的某一列（不能进行多行多列的选择）</span></span><br><span class="line">print(df[<span class="number">1</span>:<span class="number">3</span>][[<span class="string">'name'</span>,<span class="string">'age'</span>]])</span><br><span class="line"><span class="comment"># 注意： df[]只能进行行选择，或列选择，不能同时多行多列选择。</span></span><br></pre></td></tr></table></figure>

<pre><code>    name age national
0  James  18       us
--------------------
       name age national
1     Curry  20    China
2  Iversion  19       us
--------------------
       name age
1     Curry  20
2  Iversion  19</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'''df.loc 通过标签索引行数据</span></span><br><span class="line"><span class="string">df.iloc 通过位置获取行数据</span></span><br><span class="line"><span class="string">'''</span></span><br><span class="line"><span class="comment"># 获取某一行某一列的数据</span></span><br><span class="line">print(df.loc[<span class="number">0</span>,<span class="string">'name'</span>])</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 一行所有列</span></span><br><span class="line">print(df.loc[<span class="number">0</span>,:])</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 某一行多列的数据</span></span><br><span class="line">print(df.loc[<span class="number">0</span>,[<span class="string">'name'</span>,<span class="string">'age'</span>]])</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 选择间隔的多行多列</span></span><br><span class="line">print(df.loc[[<span class="number">0</span>,<span class="number">2</span>],[<span class="string">'name'</span>,<span class="string">'national'</span>]])</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 选择连续的多行和间隔的多列</span></span><br><span class="line">print(df.loc[<span class="number">0</span>:<span class="number">2</span>,[<span class="string">'name'</span>,<span class="string">'national'</span>]])</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 取一行</span></span><br><span class="line">print(df.iloc[<span class="number">1</span>])</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 取连续多行</span></span><br><span class="line">print(df.iloc[<span class="number">0</span>:<span class="number">2</span>])</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 取间断的多行</span></span><br><span class="line">print(df.iloc[[<span class="number">0</span>,<span class="number">2</span>],:])</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 取某一列</span></span><br><span class="line">print(df.iloc[:,<span class="number">1</span>])</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 某一个值</span></span><br><span class="line">print(df.iloc[<span class="number">1</span>,<span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<pre><code>James
--------------------
name        James
age            18
national       us
Name: 0, dtype: object
--------------------
name    James
age        18
Name: 0, dtype: object
--------------------
       name national
0     James       us
2  Iversion       us
--------------------
       name national
0     James       us
1     Curry    China
2  Iversion       us
--------------------
name        Curry
age            20
national    China
Name: 1, dtype: object
--------------------
    name age national
0  James  18       us
1  Curry  20    China
--------------------
       name age national
0     James  18       us
2  Iversion  19       us
--------------------
0    18
1    20
2    19
Name: age, dtype: object
--------------------
Curry</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改值</span></span><br><span class="line">df.iloc[<span class="number">0</span>,<span class="number">0</span>]=<span class="string">'panda'</span> </span><br><span class="line">print(df)</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">40</span>)</span><br><span class="line"><span class="comment"># dataframe中的排序方法</span></span><br><span class="line">df = df.sort_values(by=<span class="string">'age'</span>,ascending=<span class="literal">False</span>) </span><br><span class="line"><span class="comment"># ascending=False： 降序排列，默认是升序</span></span><br><span class="line">print(df)</span><br></pre></td></tr></table></figure>

<pre><code>       name age national
1     panda  20    China
2  Iversion  19       us
0     panda  18       us
----------------------------------------
       name age national
1     panda  20    China
2  Iversion  19       us
0     panda  18       us</code></pre><h3 id="dataframe修改index、columns"><a href="#dataframe修改index、columns" class="headerlink" title="dataframe修改index、columns"></a>dataframe修改index、columns</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df1=pd.DataFrame(np.arange(<span class="number">9</span>).reshape(<span class="number">3</span>,<span class="number">3</span>),index=[<span class="string">'bi'</span>,<span class="string">'sh'</span>,<span class="string">'oz'</span>],columns=[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>])</span><br><span class="line">print(df1)</span><br></pre></td></tr></table></figure>

<pre><code>    a  b  c
bi  0  1  2
sh  3  4  5
oz  6  7  8</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#修改df1的index</span></span><br><span class="line">df1.index=[<span class="string">'beijing'</span>,<span class="string">'shanghai'</span>,<span class="string">'xiamen'</span>]</span><br><span class="line">print(df1)</span><br></pre></td></tr></table></figure>

<pre><code>          a  b  c
beijing   0  1  2
shanghai  3  4  5
xiamen    6  7  8</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#定义map函数（x是原有行列）</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_map</span><span class="params">(x)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> x+<span class="string">'_ABC'</span></span><br><span class="line">print(df1.rename(index=test_map,columns=test_map))</span><br></pre></td></tr></table></figure>

<pre><code>              a_ABC  b_ABC  c_ABC
beijing_ABC       0      1      2
shanghai_ABC      3      4      5
xiamen_ABC        6      7      8</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 同时，renme可以传入字典，为某个index单独修改名称</span></span><br><span class="line"></span><br><span class="line">df2=df1.rename(index=&#123;<span class="string">'beijing'</span>:<span class="string">'bi'</span>&#125;,columns=&#123;<span class="string">'a'</span>:<span class="string">'aa'</span>&#125;)</span><br><span class="line">print(df2)</span><br></pre></td></tr></table></figure>

<pre><code>          aa  b  c
bi         0  1  2
shanghai   3  4  5
xiamen     6  7  8</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列转化为索引</span></span><br><span class="line">df3=pd.DataFrame(&#123;<span class="string">'X'</span>:range(<span class="number">5</span>),<span class="string">'Y'</span>:range(<span class="number">5</span>),<span class="string">'S'</span>:[<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'d'</span>,<span class="string">'e'</span>],<span class="string">'Z'</span>:[<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">2</span>]&#125;) </span><br><span class="line">print(df3)</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">30</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定一列为索引 (drop=False 指定同时保留作为索引的列) </span></span><br><span class="line">result = df3.set_index(<span class="string">'S'</span>,drop=<span class="literal">False</span>) </span><br><span class="line">result.index.name=<span class="literal">None</span></span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>

<pre><code>   X  Y  S  Z
0  0  0  a  1
1  1  1  b  1
2  2  2  c  2
3  3  3  d  2
4  4  4  e  2
------------------------------
   X  Y  S  Z
a  0  0  a  1
b  1  1  b  1
c  2  2  c  2
d  3  3  d  2
e  4  4  e  2</code></pre><h3 id="添加数据"><a href="#添加数据" class="headerlink" title="添加数据"></a>添加数据</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 增加数据</span></span><br><span class="line">df1 = pd.DataFrame([[<span class="string">'Snow'</span>,<span class="string">'M'</span>,<span class="number">22</span>],[<span class="string">'Tyrion'</span>,<span class="string">'M'</span>,<span class="number">32</span>],[<span class="string">'Sansa'</span>,<span class="string">'F'</span>,<span class="number">18</span>],[<span class="string">'Arya'</span>,<span class="string">'F'</span>,<span class="number">14</span>]], columns=[<span class="string">'name'</span>,<span class="string">'gender'</span>,<span class="string">'age'</span>])</span><br><span class="line">print(df1)</span><br></pre></td></tr></table></figure>

<pre><code>     name gender  age
0    Snow      M   22
1  Tyrion      M   32
2   Sansa      F   18
3    Arya      F   14</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#在数据框最后加上score</span></span><br><span class="line">df1[<span class="string">'score'</span>]=[<span class="number">80</span>,<span class="number">90</span>,<span class="number">67</span>,<span class="number">78</span>]<span class="comment">#与增加数据一样</span></span><br><span class="line">print(df1)</span><br></pre></td></tr></table></figure>

<pre><code>     name gender  age  score
0    Snow      M   22     80
1  Tyrion      M   32     90
2   Sansa      F   18     67
3    Arya      F   14     78</code></pre><p> 在具体某个位置插入一列可以用<strong>insert</strong>的方法</p>
<ul>
<li>语法格式：列表.insert(index, obj)<ul>
<li>index —&gt;对象 obj 需要插入的索引位置。</li>
<li>obj —&gt; 要插入列表中的对象（列名）</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">col_name=df1.columns.tolist()<span class="comment">#将数据框中列明全部提取出存在列表里</span></span><br><span class="line">col_name.insert(<span class="number">2</span>,<span class="string">'city'</span>) <span class="comment">#在列索引为2的位置后面插入列名为city的列</span></span><br><span class="line"><span class="comment">#没有值，所有列为NaN</span></span><br><span class="line">df1=df1.reindex(columns=col_name)<span class="comment"># DataFrame.reindex() 对原行/列索引重新构建索引值</span></span><br><span class="line">print(df1)</span><br></pre></td></tr></table></figure>

<pre><code>     name gender  city  age  score
0    Snow      M   NaN   22     80
1  Tyrion      M   NaN   32     90
2   Sansa      F   NaN   18     67
3    Arya      F   NaN   14     78</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df1[<span class="string">'city'</span>]=[<span class="string">'北京'</span>,<span class="string">'上海'</span>,<span class="string">'广东'</span>,<span class="string">'厦门'</span>]</span><br><span class="line">print(df1)</span><br></pre></td></tr></table></figure>

<pre><code>     name gender city  age  score
0    Snow      M   北京   22     80
1  Tyrion      M   上海   32     90
2   Sansa      F   广东   18     67
3    Arya      F   厦门   14     78</code></pre><h4 id="df中的insert-插入一列"><a href="#df中的insert-插入一列" class="headerlink" title="df中的insert,插入一列"></a>df中的insert,插入一列</h4><p>df.insert(iloc,column,value)</p>
<ul>
<li>iloc:要插入的位置</li>
<li>colunm:列名</li>
<li>value:值</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df1.insert(<span class="number">2</span>,<span class="string">'score2'</span>,[<span class="number">79</span>,<span class="number">43</span>,<span class="number">67</span>,<span class="number">89</span>])</span><br><span class="line">print(df1)</span><br></pre></td></tr></table></figure>

<pre><code>     name gender  score2 city  age  score
0    Snow      M      79   北京   22     80
1  Tyrion      M      43   上海   32     90
2   Sansa      F      67   广东   18     67
3    Arya      F      89   厦门   14     78</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 插入行</span></span><br><span class="line">row=[<span class="string">'Ryan'</span>,<span class="string">'M'</span>,<span class="string">'100'</span>,<span class="string">'厦门'</span>,<span class="string">'18'</span>,<span class="string">'100'</span>]</span><br><span class="line">df1.loc[<span class="number">3</span>]=row</span><br><span class="line">print(df1)</span><br></pre></td></tr></table></figure>

<pre><code>     name gender score2 city age score
0    Snow      M     79   北京  22    80
1  Tyrion      M     43   上海  32    90
2   Sansa      F     67   广东  18    67
3    Ryan      M    100   厦门  18   100</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 增加数据</span></span><br><span class="line">df1 = pd.DataFrame([[<span class="string">'Snow'</span>,<span class="string">'M'</span>,<span class="number">22</span>],</span><br><span class="line">                    [<span class="string">'Tyrion'</span>,<span class="string">'M'</span>,<span class="number">32</span>],</span><br><span class="line">                    [<span class="string">'Sansa'</span>,<span class="string">'F'</span>,<span class="number">18</span>],</span><br><span class="line">                    [<span class="string">'Arya'</span>,<span class="string">'F'</span>,<span class="number">14</span>]], </span><br><span class="line">                   columns=[<span class="string">'name'</span>,<span class="string">'gender'</span>,<span class="string">'age'</span>])</span><br><span class="line">print(df1)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 先创建一个DataFrame，用来增加进数据框的最后一行</span></span><br><span class="line">new=pd.DataFrame(&#123;<span class="string">'name'</span>:<span class="string">'lisa'</span>,</span><br><span class="line">                  <span class="string">'gender'</span>:<span class="string">'F'</span>, <span class="string">'age'</span>:<span class="number">19</span>&#125;,</span><br><span class="line">                 index=[<span class="number">0</span>])</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">30</span>)</span><br><span class="line">print(new)</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">30</span>)</span><br><span class="line">df1=df1.append(new,ignore_index=<span class="literal">True</span>)	<span class="comment"># ignore_index=False,表示不按原来的索引，从0开始自动递增</span></span><br><span class="line">print(df1)</span><br></pre></td></tr></table></figure>

<pre><code>     name gender  age
0    Snow      M   22
1  Tyrion      M   32
2   Sansa      F   18
3    Arya      F   14
------------------------------
   name gender  age
0  lisa      F   19
------------------------------
     name gender  age
0    Snow      M   22
1  Tyrion      M   32
2   Sansa      F   18
3    Arya      F   14
4    lisa      F   19</code></pre><h4 id="插入多行多列"><a href="#插入多行多列" class="headerlink" title="插入多行多列"></a>插入多行多列</h4><ul>
<li>objs:合并对象</li>
<li>axis:合并方式，默认0表示按列合并，1表示按行合并</li>
<li>ignore_index:是否忽略索引</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">df1 = pd.DataFrame(np.arange(<span class="number">6</span>).reshape(<span class="number">3</span>,<span class="number">2</span>),columns=[<span class="string">'four'</span>,<span class="string">'five'</span>])</span><br><span class="line">df2 = pd.DataFrame(np.arange(<span class="number">6</span>).reshape(<span class="number">2</span>,<span class="number">3</span>),columns=[<span class="string">'one'</span>,<span class="string">'two'</span>,<span class="string">'three'</span>]) </span><br><span class="line">print(df2)</span><br><span class="line"></span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">30</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 按行合并</span></span><br><span class="line">result=pd.concat([df2,df1],axis=<span class="number">1</span>)</span><br><span class="line">print(result)</span><br><span class="line"></span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">30</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 按列合并</span></span><br><span class="line">result=pd.concat([df2,df1],ignore_index=<span class="literal">True</span>,)</span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>

<pre><code>   one  two  three
0    0    1      2
1    3    4      5
------------------------------
   one  two  three  four  five
0  0.0  1.0    2.0     0     1
1  3.0  4.0    5.0     2     3
2  NaN  NaN    NaN     4     5
------------------------------
   five  four  one  three  two
0   NaN   NaN  0.0    2.0  1.0
1   NaN   NaN  3.0    5.0  4.0
2   1.0   0.0  NaN    NaN  NaN
3   3.0   2.0  NaN    NaN  NaN
4   5.0   4.0  NaN    NaN  NaN



E:\anaconda\lib\site-packages\ipykernel_launcher.py:14: FutureWarning: Sorting because non-concatenation axis is not aligned. A future version
of pandas will change to not sort by default.

To accept the future behavior, pass &apos;sort=True&apos;.

To retain the current behavior and silence the warning, pass sort=False</code></pre><p>​<br>​    </p>
<h4 id="DataFrame的删除"><a href="#DataFrame的删除" class="headerlink" title="DataFrame的删除"></a>DataFrame的删除</h4><ul>
<li>lables：要删除数据的标签</li>
<li>axis：0表示删除行，1表示删除列，默认0</li>
<li>inplace:是否在当前df中执行此操作</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">df2 = pd.DataFrame(np.arange(<span class="number">9</span>).reshape(<span class="number">3</span>,<span class="number">3</span>),columns=[<span class="string">'one'</span>,<span class="string">'two'</span>,<span class="string">'three'</span>])</span><br><span class="line">print(df2)</span><br><span class="line">df4=df2.drop([<span class="string">'one'</span>],axis=<span class="number">1</span>, inplace=<span class="literal">False</span>) </span><br><span class="line">df3=df2.drop([<span class="number">0</span>,<span class="number">1</span>],axis=<span class="number">0</span>, inplace=<span class="literal">False</span>) </span><br><span class="line"></span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">30</span>)</span><br><span class="line">print(df4)</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">30</span>)</span><br><span class="line">print(df3)</span><br></pre></td></tr></table></figure>

<pre><code>   one  two  three
0    0    1      2
1    3    4      5
2    6    7      8
------------------------------
   two  three
0    1      2
1    4      5
2    7      8
------------------------------
   one  two  three
2    6    7      8</code></pre><h3 id="数据处理"><a href="#数据处理" class="headerlink" title="数据处理"></a>数据处理</h3><h4 id="通过dropna-滤除缺失数据："><a href="#通过dropna-滤除缺失数据：" class="headerlink" title="通过dropna()滤除缺失数据："></a>通过<strong>dropna()</strong>滤除缺失数据：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">se=pd.Series([<span class="number">4</span>,<span class="literal">None</span>,<span class="number">8</span>,<span class="literal">None</span>,<span class="number">5</span>]) </span><br><span class="line">print(se)</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line">print(se.dropna())</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line">print(se.notnull()) </span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line">print(se.isnull())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 通过布尔序列也能滤除：</span></span><br><span class="line">print(se[se.notnull()])</span><br></pre></td></tr></table></figure>

<pre><code>0    4.0
1    NaN
2    8.0
3    NaN
4    5.0
dtype: float64
--------------------
0    4.0
2    8.0
4    5.0
dtype: float64
--------------------
0     True
1    False
2     True
3    False
4     True
dtype: bool
--------------------
0    False
1     True
2    False
3     True
4    False
dtype: bool
--------------------
0    4.0
2    8.0
4    5.0
dtype: float64</code></pre><h4 id="处理DataFrame对象"><a href="#处理DataFrame对象" class="headerlink" title="处理DataFrame对象"></a>处理DataFrame对象</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">df1=pd.DataFrame([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="literal">None</span>,<span class="literal">None</span>,<span class="number">2</span>],[<span class="literal">None</span>,<span class="literal">None</span>,<span class="literal">None</span>],[<span class="number">8</span>,<span class="number">8</span>,<span class="literal">None</span>]])</span><br><span class="line">print(df1)</span><br><span class="line"></span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line">print(df1.dropna())</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 传入how=‘all’滤除全为NaN的行：</span></span><br><span class="line">print(df1.dropna(how=<span class="string">'all'</span>)) <span class="comment"># 默认情况下是how='any'，只要有nan就删除</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 传入axis=1滤除列：</span></span><br><span class="line">print(df1.dropna(axis=<span class="number">1</span>,how=<span class="string">"any"</span>))</span><br><span class="line"></span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment">#传入thresh=n保留至少有n个非NaN数据的行：  </span></span><br><span class="line">print(df1.dropna(thresh=<span class="number">3</span>))</span><br></pre></td></tr></table></figure>

<pre><code>     0    1    2
0  1.0  2.0  3.0
1  NaN  NaN  2.0
2  NaN  NaN  NaN
3  8.0  8.0  NaN
--------------------
     0    1    2
0  1.0  2.0  3.0
--------------------
     0    1    2
0  1.0  2.0  3.0
1  NaN  NaN  2.0
3  8.0  8.0  NaN
--------------------
Empty DataFrame
Columns: []
Index: [0, 1, 2, 3]
--------------------
     0    1    2
0  1.0  2.0  3.0</code></pre><h4 id="填充缺失数据"><a href="#填充缺失数据" class="headerlink" title="填充缺失数据"></a>填充缺失数据</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">df1=pd.DataFrame([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="literal">None</span>,<span class="literal">None</span>,<span class="number">2</span>],[<span class="literal">None</span>,<span class="literal">None</span>,<span class="literal">None</span>],[<span class="number">8</span>,<span class="number">8</span>,<span class="literal">None</span>]])</span><br><span class="line">print(df1)</span><br></pre></td></tr></table></figure>

<pre><code>     0    1    2
0  1.0  2.0  3.0
1  NaN  NaN  2.0
2  NaN  NaN  NaN
3  8.0  8.0  NaN</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用常数填充fillna</span></span><br><span class="line">print(df1.fillna(<span class="number">0</span>))</span><br></pre></td></tr></table></figure>

<pre><code>     0    1    2
0  1.0  2.0  3.0
1  0.0  0.0  2.0
2  0.0  0.0  0.0
3  8.0  8.0  0.0</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#传入inplace=True直接修改原对象： </span></span><br><span class="line">df1.fillna(<span class="number">0</span>,inplace=<span class="literal">True</span>) </span><br><span class="line">print(df1)</span><br></pre></td></tr></table></figure>

<pre><code>     0    1    2
0  1.0  2.0  3.0
1  0.0  0.0  2.0
2  0.0  0.0  0.0
3  8.0  8.0  0.0</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">df1=pd.DataFrame([[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],[<span class="literal">None</span>,<span class="literal">None</span>,<span class="number">2</span>],[<span class="literal">None</span>,<span class="literal">None</span>,<span class="literal">None</span>],[<span class="number">8</span>,<span class="number">8</span>,<span class="literal">None</span>]])</span><br><span class="line"><span class="comment"># 通过字典填充不同的常数</span></span><br><span class="line">print(df1.fillna(&#123;<span class="number">0</span>:<span class="number">10</span>,<span class="number">1</span>:<span class="number">20</span>,<span class="number">2</span>:<span class="number">30</span>&#125;))</span><br></pre></td></tr></table></figure>

<pre><code>      0     1     2
0   1.0   2.0   3.0
1  10.0  20.0   2.0
2  10.0  20.0  30.0
3   8.0   8.0  30.0</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#填充平均值</span></span><br><span class="line">print(df1.fillna(df1.mean()))</span><br><span class="line"><span class="comment"># 如果只填充一列</span></span><br><span class="line">df1.iloc[:,<span class="number">1</span>].fillna(<span class="number">5</span>,inplace = <span class="literal">True</span>)</span><br><span class="line">print(df1)</span><br></pre></td></tr></table></figure>

<pre><code>     0    1    2
0  1.0  2.0  3.0
1  4.5  5.0  2.0
2  4.5  5.0  2.5
3  8.0  8.0  2.5
     0    1    2
0  1.0  2.0  3.0
1  NaN  5.0  2.0
2  NaN  5.0  NaN
3  8.0  8.0  NaN</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 传 入 method=” “ 改 变 插 值 方 式 ： </span></span><br><span class="line">df2=pd.DataFrame(np.random.randint(<span class="number">0</span>,<span class="number">10</span>,(<span class="number">5</span>,<span class="number">5</span>))) </span><br><span class="line">df2.iloc[<span class="number">1</span>:<span class="number">4</span>,<span class="number">3</span>]=<span class="literal">None</span></span><br><span class="line">df2.iloc[<span class="number">2</span>:<span class="number">4</span>,<span class="number">4</span>]=<span class="literal">None</span></span><br><span class="line">print(df2)</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#用前面的值来填充ffill	用后面的值来填充bfill </span></span><br><span class="line">print(df2.fillna(method=<span class="string">'ffill'</span>))</span><br><span class="line"></span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 传入limit=” “限制填充行数：</span></span><br><span class="line">print(df2.fillna(method=<span class="string">'bfill'</span>,limit=<span class="number">2</span>))</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line"><span class="comment"># 传入axis=” “修改填充方向：</span></span><br><span class="line">print(df2.fillna(method=<span class="string">"ffill"</span>,limit=<span class="number">1</span>,axis=<span class="number">1</span>))</span><br></pre></td></tr></table></figure>

<pre><code>   0  1  2    3    4
0  7  6  9  4.0  4.0
1  8  1  7  NaN  5.0
2  2  7  0  NaN  NaN
3  7  3  2  NaN  NaN
4  1  0  7  7.0  4.0
--------------------
   0  1  2    3    4
0  7  6  9  4.0  4.0
1  8  1  7  4.0  5.0
2  2  7  0  4.0  5.0
3  7  3  2  4.0  5.0
4  1  0  7  7.0  4.0
--------------------
   0  1  2    3    4
0  7  6  9  4.0  4.0
1  8  1  7  NaN  5.0
2  2  7  0  7.0  4.0
3  7  3  2  7.0  4.0
4  1  0  7  7.0  4.0
--------------------
     0    1    2    3    4
0  7.0  6.0  9.0  4.0  4.0
1  8.0  1.0  7.0  7.0  5.0
2  2.0  7.0  0.0  0.0  NaN
3  7.0  3.0  2.0  2.0  NaN
4  1.0  0.0  7.0  7.0  4.0</code></pre><h4 id="移除重复数据"><a href="#移除重复数据" class="headerlink" title="移除重复数据"></a>移除重复数据</h4><p>DataFrame中经常会出现重复行，利用duplicated()函数返回每一行判断是否重复的结果（重复则为True) </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">df1=pd.DataFrame(&#123;<span class="string">'A'</span>:[<span class="number">1</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">1</span>],<span class="string">'B'</span>:list(<span class="string">"aabbbca"</span>)&#125;) </span><br><span class="line">print(df1)</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">30</span>)</span><br><span class="line"><span class="comment"># 判断每一行是否重复(结果是bool值，TRUE代表重复的) </span></span><br><span class="line">print(df1.duplicated())</span><br><span class="line"></span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">30</span>)</span><br><span class="line"><span class="comment"># 去除全部的重复行</span></span><br><span class="line">print(df1.drop_duplicates())</span><br><span class="line"></span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">30</span>)</span><br><span class="line"><span class="comment">#  指定列去除重复行</span></span><br><span class="line">print(df1.drop_duplicates([<span class="string">'A'</span>]))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">30</span>)</span><br><span class="line"><span class="comment"># 保留重复行中的最后一行</span></span><br><span class="line">print(df1.drop_duplicates([<span class="string">'A'</span>],keep=<span class="string">'last'</span>))</span><br><span class="line"></span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">30</span>)</span><br><span class="line"><span class="comment">#去除重复的同时改变DataFrame对象</span></span><br><span class="line">df1.drop_duplicates([<span class="string">'A'</span>,<span class="string">'B'</span>],inplace=<span class="literal">True</span>) </span><br><span class="line">print(df1)</span><br></pre></td></tr></table></figure>

<pre><code>   A  B
0  1  a
1  1  a
2  1  b
3  2  b
4  2  b
5  3  c
6  1  a
------------------------------
0    False
1     True
2    False
3    False
4     True
5    False
6     True
dtype: bool
------------------------------
   A  B
0  1  a
2  1  b
3  2  b
5  3  c
------------------------------
   A  B
0  1  a
3  2  b
5  3  c
------------------------------
   A  B
4  2  b
5  3  c
6  1  a
------------------------------
   A  B
0  1  a
2  1  b
3  2  b
5  3  c</code></pre><h3 id="数据合并"><a href="#数据合并" class="headerlink" title="数据合并"></a>数据合并</h3><h4 id="join合并"><a href="#join合并" class="headerlink" title="join合并"></a>join合并</h4><p>着重关注行的合并</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">df3=pd.DataFrame(&#123;<span class="string">'Red'</span>:[<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>],<span class="string">'Green'</span>:[<span class="number">5</span>,<span class="number">0</span>,<span class="number">3</span>]&#125;,index=list(<span class="string">'abc'</span>))</span><br><span class="line">df4=pd.DataFrame(&#123;<span class="string">'Blue'</span>:[<span class="number">1</span>,<span class="number">9</span>,<span class="number">8</span>],<span class="string">'Yellow'</span>:[<span class="number">6</span>,<span class="number">6</span>,<span class="number">7</span>]&#125;,index=list(<span class="string">'cde'</span>)) </span><br><span class="line">print(df3)</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">30</span>)</span><br><span class="line">print(df4)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 简单合并（默认是left左连接,以左侧df3为基础）</span></span><br><span class="line">df3.join(df4,how=<span class="string">'left'</span>)</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">30</span>)</span><br><span class="line">print(df3)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 右链接</span></span><br><span class="line">df3.join(df4,how=<span class="string">'right'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 外链接</span></span><br><span class="line">df3.join(df4,how=<span class="string">'outer'</span>)</span><br></pre></td></tr></table></figure>

<pre><code>   Red  Green
a    1      5
b    3      0
c    5      3
------------------------------
   Blue  Yellow
c     1       6
d     9       6
e     8       7
------------------------------
   Red  Green
a    1      5
b    3      0
c    5      3</code></pre><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Red</th>
      <th>Green</th>
      <th>Blue</th>
      <th>Yellow</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>b</th>
      <td>3.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>c</th>
      <td>5.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>d</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>9.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>e</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>8.0</td>
      <td>7.0</td>
    </tr>
  </tbody>
</table>

</div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 合并多个DataFrame对象</span></span><br><span class="line">df5=pd.DataFrame(&#123;<span class="string">'Brown'</span>:[<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>],<span class="string">'White'</span>:[<span class="number">1</span>,<span class="number">1</span>,<span class="number">2</span>]&#125;,index=list(<span class="string">'aed'</span>)) </span><br><span class="line"></span><br><span class="line">df3.join([df4,df5])</span><br></pre></td></tr></table></figure>




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Red</th>
      <th>Green</th>
      <th>Blue</th>
      <th>Yellow</th>
      <th>Brown</th>
      <th>White</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1</td>
      <td>5</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>b</th>
      <td>3</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>c</th>
      <td>5</td>
      <td>3</td>
      <td>1.0</td>
      <td>6.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>

</div>



<h4 id="merge合并"><a href="#merge合并" class="headerlink" title="merge合并"></a>merge合并</h4><p>着重关注的是列的合并</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">df1=pd.DataFrame(&#123;<span class="string">'名字'</span>:list(<span class="string">'ABCDE'</span>),<span class="string">'性别'</span>:[<span class="string">'男'</span>,<span class="string">'女'</span>,<span class="string">'男'</span>,<span class="string">'男'</span>,<span class="string">'女'</span>],<span class="string">'职称'</span>:[<span class="string">'副教授'</span>,<span class="string">'讲     师'</span>,<span class="string">'助教'</span>,<span class="string">'教授'</span>,<span class="string">'助教'</span>]&#125;,</span><br><span class="line">                 index=range(<span class="number">1001</span>,<span class="number">1006</span>))</span><br><span class="line">df1.columns.name=<span class="string">'学院老师'</span></span><br><span class="line">df1.index.name=<span class="string">'编号'</span></span><br><span class="line">print(df1)</span><br><span class="line"></span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line">df2=pd.DataFrame(&#123;<span class="string">'名字'</span>:list(<span class="string">'ABDAX'</span>),<span class="string">'课程'</span>:[<span class="string">'C++'</span>,<span class="string">'计算机导论'</span>,<span class="string">'汇编'</span>,<span class="string">'数据结构'</span>,<span class="string">'马克思原理'</span>],<span class="string">'职称'</span>:[<span class="string">'副教授'</span>,<span class="string">'讲师'</span>,<span class="string">'教授'</span>,<span class="string">'副教授'</span>,<span class="string">'讲师'</span>]&#125;,index=[<span class="number">1001</span>,<span class="number">1002</span>,<span class="number">1004</span>,<span class="number">1001</span>,<span class="number">3001</span>])</span><br><span class="line">df2.columns.name=<span class="string">'课程'</span></span><br><span class="line">df2.index.name=<span class="string">'编号'</span></span><br><span class="line">print(df2)</span><br></pre></td></tr></table></figure>

<pre><code>学院老师 名字 性别       职称
编号                 
1001  A  男      副教授
1002  B  女  讲     师
1003  C  男       助教
1004  D  男       教授
1005  E  女       助教
--------------------
课程   名字     课程   职称
编号                 
1001  A    C++  副教授
1002  B  计算机导论   讲师
1004  D     汇编   教授
1001  A   数据结构  副教授
3001  X  马克思原理   讲师</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 默认下是根据左右对象中出现同名的列作为连接的键，且连接方式是how=’inner’ </span></span><br><span class="line">print(pd.merge(df1,df2))<span class="comment"># 返回匹配的</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定列名合并</span></span><br><span class="line">pd.merge(df1,df2,on=<span class="string">'名字'</span>,suffixes=[<span class="string">'_1'</span>,<span class="string">'_2'</span>])<span class="comment"># 返回匹配的</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 连接方式，根据左侧为准</span></span><br><span class="line">pd.merge(df1,df2,how=<span class="string">'left'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据左侧为准</span></span><br><span class="line">pd.merge(df1,df2,how=<span class="string">'right'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 所 有</span></span><br><span class="line"><span class="comment"># pd.merge(df1,df2,how='outer')</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据多个键进行连接</span></span><br><span class="line">pd.merge(df1,df2,on=[<span class="string">'职称'</span>,<span class="string">'名字'</span>])</span><br></pre></td></tr></table></figure>

<pre><code>  名字 性别   职称    课程
0  A  男  副教授   C++
1  A  男  副教授  数据结构
2  D  男   教授    汇编</code></pre><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>名字</th>
      <th>性别</th>
      <th>职称</th>
      <th>课程</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>A</td>
      <td>男</td>
      <td>副教授</td>
      <td>C++</td>
    </tr>
    <tr>
      <th>1</th>
      <td>A</td>
      <td>男</td>
      <td>副教授</td>
      <td>数据结构</td>
    </tr>
    <tr>
      <th>2</th>
      <td>D</td>
      <td>男</td>
      <td>教授</td>
      <td>汇编</td>
    </tr>
  </tbody>
</table>

</div>



<h3 id="拓展——轴向连接（Concat）"><a href="#拓展——轴向连接（Concat）" class="headerlink" title="拓展——轴向连接（Concat）"></a>拓展——轴向连接（Concat）</h3><ol>
<li>Series对象的连接</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">s1=pd.Series([<span class="number">1</span>,<span class="number">2</span>],index=list(<span class="string">'ab'</span>))</span><br><span class="line">s2=pd.Series([<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>],index=list(<span class="string">'bde'</span>)) </span><br><span class="line">print(s1)</span><br><span class="line">print(s2)</span><br><span class="line">print(pd.concat([s1,s2]))</span><br><span class="line"></span><br><span class="line"><span class="comment">#横向连接</span></span><br><span class="line">print(pd.concat([s1,s2],axis=<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用内连接求交集(连接方式，共有’inner’,’left’,right’,’outer’) </span></span><br><span class="line">pd.concat([s1,s2],axis=<span class="number">1</span>,join=<span class="string">'inner'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定部分索引进行连接</span></span><br><span class="line">pd.concat([s1,s2],axis=<span class="number">1</span>,join_axes=[list(<span class="string">'abc'</span>)])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建层次化索引</span></span><br><span class="line">pd.concat([s1,s2],keys=[<span class="string">'A'</span>,<span class="string">'B'</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#当纵向连接时keys为列名</span></span><br><span class="line">pd.concat([s1,s2],keys=[<span class="string">'A'</span>,<span class="string">'D'</span>],axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<pre><code>a    1
b    2
dtype: int64
b    3
d    4
e    5
dtype: int64
a    1
b    2
b    3
d    4
e    5
dtype: int64
     0    1
a  1.0  NaN
b  2.0  3.0
d  NaN  4.0
e  NaN  5.0



E:\anaconda\lib\site-packages\ipykernel_launcher.py:8: FutureWarning: Sorting because non-concatenation axis is not aligned. A future version
of pandas will change to not sort by default.

To accept the future behavior, pass &apos;sort=True&apos;.

To retain the current behavior and silence the warning, pass sort=False</code></pre><p>​<br>​    E:\anaconda\lib\site-packages\ipykernel_launcher.py:20: FutureWarning: Sorting because non-concatenation axis is not aligned. A future version<br>​    of pandas will change to not sort by default.<br>​<br>​    To accept the future behavior, pass ‘sort=True’.<br>​    </p>
<pre><code>To retain the current behavior and silence the warning, pass sort=False</code></pre><p>​    </p>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead th {
    text-align: right;
}</code></pre><p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>A</th>
      <th>D</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>b</th>
      <td>2.0</td>
      <td>3.0</td>
    </tr>
    <tr>
      <th>d</th>
      <td>NaN</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>e</th>
      <td>NaN</td>
      <td>5.0</td>
    </tr>
  </tbody>
</table>

</div>



<ol start="2">
<li>DataFrame对象的连接</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">df3=pd.DataFrame(&#123;<span class="string">'Red'</span>:[<span class="number">1</span>,<span class="number">3</span>,<span class="number">5</span>],<span class="string">'Green'</span>:[<span class="number">5</span>,<span class="number">0</span>,<span class="number">3</span>]&#125;,index=list(<span class="string">'abd'</span>))</span><br><span class="line">df4=pd.DataFrame(&#123;<span class="string">'Blue'</span>:[<span class="number">1</span>,<span class="number">9</span>],<span class="string">'Yellow'</span>:[<span class="number">6</span>,<span class="number">6</span>]&#125;,index=list(<span class="string">'ce'</span>)) </span><br><span class="line">print(df3)</span><br><span class="line">print(df4)</span><br><span class="line">pd.concat([df3,df4]) </span><br><span class="line">pd.concat([df3,df4],axis=<span class="number">1</span>,keys=[<span class="string">'A'</span>,<span class="string">'B'</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用字典的方式连接同样可以创建层次化列索引</span></span><br><span class="line">pd.concat(&#123;<span class="string">'A'</span>:df3,<span class="string">'B'</span>:df4&#125;,axis=<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<pre><code>   Red  Green
a    1      5
b    3      0
d    5      3
   Blue  Yellow
c     1       6
e     9       6



E:\anaconda\lib\site-packages\ipykernel_launcher.py:5: FutureWarning: Sorting because non-concatenation axis is not aligned. A future version
of pandas will change to not sort by default.

To accept the future behavior, pass &apos;sort=True&apos;.

To retain the current behavior and silence the warning, pass sort=False

  &quot;&quot;&quot;
E:\anaconda\lib\site-packages\ipykernel_launcher.py:6: FutureWarning: Sorting because non-concatenation axis is not aligned. A future version
of pandas will change to not sort by default.

To accept the future behavior, pass &apos;sort=True&apos;.

To retain the current behavior and silence the warning, pass sort=False</code></pre><p>​<br>​    E:\anaconda\lib\site-packages\ipykernel_launcher.py:9: FutureWarning: Sorting because non-concatenation axis is not aligned. A future version<br>​    of pandas will change to not sort by default.<br>​<br>​    To accept the future behavior, pass ‘sort=True’.<br>​    </p>
<pre><code>To retain the current behavior and silence the warning, pass sort=False

  if __name__ == &apos;__main__&apos;:</code></pre><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }


<pre><code>.dataframe tbody tr th {
    vertical-align: top;
}

.dataframe thead tr th {
    text-align: left;
}</code></pre><p></style><p></p>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="2" halign="left">A</th>
      <th colspan="2" halign="left">B</th>
    </tr>
    <tr>
      <th></th>
      <th>Red</th>
      <th>Green</th>
      <th>Blue</th>
      <th>Yellow</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>a</th>
      <td>1.0</td>
      <td>5.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>b</th>
      <td>3.0</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>c</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>6.0</td>
    </tr>
    <tr>
      <th>d</th>
      <td>5.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>e</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>9.0</td>
      <td>6.0</td>
    </tr>
  </tbody>
</table>

</div>



<h3 id="多层索引（拓展）"><a href="#多层索引（拓展）" class="headerlink" title="多层索引（拓展）"></a>多层索引（拓展）</h3><h4 id="创建多层索引"><a href="#创建多层索引" class="headerlink" title="创建多层索引"></a>创建多层索引</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np </span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> pandas <span class="keyword">import</span> Series,DataFrame</span><br><span class="line"></span><br><span class="line"><span class="comment"># Series也可以创建多层索引</span></span><br><span class="line">s = Series(np.random.randint(<span class="number">0</span>,<span class="number">150</span>,size=<span class="number">6</span>),index=list(<span class="string">'abcdef'</span>)) </span><br><span class="line">print(s)</span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line">s = Series(np.random.randint(<span class="number">0</span>,<span class="number">150</span>,size=<span class="number">6</span>),</span><br><span class="line">           index=[[<span class="string">'a'</span>,<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'c'</span>],[<span class="string">'期中'</span>,<span class="string">'期末'</span>,<span class="string">'期中'</span>,<span class="string">'期末'</span>,<span class="string">'期中'</span>,<span class="string">'期末'</span>]])  </span><br><span class="line">print(s)</span><br></pre></td></tr></table></figure>

<pre><code>a    146
b    137
c     39
d     16
e    142
f    142
dtype: int32
--------------------
a  期中     43
   期末     53
b  期中     71
   期末    114
c  期中    149
   期末     13
dtype: int32</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#DataFrame创建多层索引</span></span><br><span class="line">df1 = DataFrame(np.random.randint(<span class="number">0</span>,<span class="number">150</span>,size=(<span class="number">6</span>,<span class="number">4</span>)),columns = [<span class="string">'zs'</span>,<span class="string">'ls'</span>,<span class="string">'ww'</span>,<span class="string">'zl'</span>],</span><br><span class="line">                index = [[<span class="string">'python'</span>,<span class="string">'python'</span>,<span class="string">'math'</span>,<span class="string">'math'</span>,<span class="string">'En'</span>,<span class="string">'En'</span>],[<span class="string">'期中'</span>,<span class="string">'期末'</span>,<span class="string">'期中'</span>,<span class="string">'期末'</span>,<span class="string">'期中'</span>,<span class="string">'期末'</span>]])</span><br><span class="line"></span><br><span class="line">print(df1)</span><br></pre></td></tr></table></figure>

<pre><code>            zs   ls   ww   zl
python 期中    7  131  141   55
       期末   77   52   85   69
math   期中  139  118   80    3
       期末   23    5   14   27
En     期中  142   47   28  136
       期末   19   95   33   55</code></pre><h5 id="特定结构"><a href="#特定结构" class="headerlink" title="特定结构"></a>特定结构</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">class1=[<span class="string">'python'</span>,<span class="string">'python'</span>,<span class="string">'math'</span>,<span class="string">'math'</span>,<span class="string">'En'</span>,<span class="string">'En'</span>]</span><br><span class="line">class2=[<span class="string">'期中'</span>,<span class="string">'期末'</span>,<span class="string">'期中'</span>,<span class="string">'期末'</span>,<span class="string">'期中'</span>,<span class="string">'期末'</span>]</span><br><span class="line">m_index2=pd.MultiIndex.from_arrays([class1,class2])</span><br><span class="line">df2=DataFrame(np.random.randint(<span class="number">0</span>,<span class="number">150</span>,(<span class="number">6</span>,<span class="number">4</span>)),index=m_index2) </span><br><span class="line">print(df2)</span><br><span class="line"></span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">class1=[<span class="string">'期中'</span>,<span class="string">'期中'</span>,<span class="string">'期中'</span>,<span class="string">'期末'</span>,<span class="string">'期末'</span>,<span class="string">'期末'</span>]</span><br><span class="line">class2=[<span class="string">'python'</span>,<span class="string">'math'</span>,<span class="string">'En'</span>,<span class="string">'python'</span>,<span class="string">'math'</span>,<span class="string">'En'</span>] </span><br><span class="line">m_index2=pd.MultiIndex.from_arrays([class1,class2])</span><br><span class="line">df2=DataFrame(np.random.randint(<span class="number">0</span>,<span class="number">150</span>,(<span class="number">6</span>,<span class="number">4</span>)),index=m_index2) </span><br><span class="line">print(df2)</span><br></pre></td></tr></table></figure>

<pre><code>             0    1    2    3
python 期中   13   13  108   94
       期末  117  130   87   74
math   期中   35  111   80   94
       期末  144   94  111    0
En     期中  135   80   87   90
       期末  108   63  119  118
--------------------
             0    1    2    3
期中 python   22   36   66   41
   math    142    5  139   73
   En       62  130  120  140
期末 python  144    5   60  128
   math     18   41   14   37
   En       74   62   10   83</code></pre><h5 id="product构造"><a href="#product构造" class="headerlink" title="product构造"></a>product构造</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">class1=[<span class="string">'python'</span>,<span class="string">'math'</span>,<span class="string">'En'</span>]</span><br><span class="line">class2=[<span class="string">'期中'</span>,<span class="string">'期末'</span>]</span><br><span class="line">m_index2=pd.MultiIndex.from_product([class1,class2]) </span><br><span class="line">df2=DataFrame(np.random.randint(<span class="number">0</span>,<span class="number">150</span>,(<span class="number">6</span>,<span class="number">4</span>)),index=m_index2) </span><br><span class="line">print(df2)</span><br></pre></td></tr></table></figure>

<pre><code>             0    1    2    3
python 期中   23   98  144  114
       期末  122   80  115   13
math   期中   79   80   43   65
       期末   99  132  103    2
En     期中    1   81   27   72
       期末   50  113   28  116</code></pre><h4 id="多层索引对象的索引"><a href="#多层索引对象的索引" class="headerlink" title="多层索引对象的索引"></a>多层索引对象的索引</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#多层索引对象的索引操作# series</span></span><br><span class="line">s = Series(np.random.randint(<span class="number">0</span>,<span class="number">150</span>,size=<span class="number">6</span>),index=[[<span class="string">'a'</span>,<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>,<span class="string">'c'</span>],[<span class="string">'期中'</span>,<span class="string">'期末'</span>,<span class="string">'期中'</span>,<span class="string">'期末'</span>,<span class="string">'期中'</span>,<span class="string">'期末'</span>]])  <span class="comment"># print(s)</span></span><br><span class="line"><span class="comment">#取一个第一级索引</span></span><br><span class="line">print(s[<span class="string">'a'</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 取多个第一级索引</span></span><br><span class="line">print(s[[<span class="string">'a'</span>,<span class="string">'b'</span>]])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 根据索引获取值</span></span><br><span class="line">print(s[<span class="string">'a'</span>,<span class="string">'期末'</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># loc方法取值</span></span><br><span class="line">print(s.loc[<span class="string">'a'</span>])</span><br><span class="line">print(s.loc[[<span class="string">'a'</span>,<span class="string">'b'</span>]])</span><br><span class="line">print(s.loc[<span class="string">'a'</span>,<span class="string">'期末'</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># iloc方法取值(iloc计算的事最内层索引)  </span></span><br><span class="line">print(s.iloc[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">print(s.iloc[<span class="number">1</span>:<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># dataframe </span></span><br><span class="line">class1=[<span class="string">'python'</span>,<span class="string">'math'</span>,<span class="string">'En'</span>]</span><br><span class="line">class2=[<span class="string">' 期 中 '</span>,<span class="string">' 期 末 '</span>] </span><br><span class="line">m_index2=pd.MultiIndex.from_product([class1,class2]) </span><br><span class="line">df2=DataFrame(np.random.randint(<span class="number">0</span>,<span class="number">150</span>,(<span class="number">6</span>,<span class="number">4</span>)),index=m_index2) </span><br><span class="line">print(df2)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取列</span></span><br><span class="line">print(df2[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 一级索引</span></span><br><span class="line">print(df2.loc[<span class="string">'python'</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 多个一级索引</span></span><br><span class="line">print(df2.loc[[<span class="string">'python'</span>,<span class="string">'math'</span>]])</span><br><span class="line"></span><br><span class="line"><span class="comment"># 取一行</span></span><br><span class="line"><span class="comment"># print(df2.loc['python','期末'])</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 取一值</span></span><br><span class="line"><span class="comment"># print(df2.loc['python','期末'][0])</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># iloc是只取最内层的索引的</span></span><br><span class="line">print(df2.iloc[<span class="number">0</span>])</span><br></pre></td></tr></table></figure>

<pre><code>期中    110
期末    123
dtype: int32
a  期中    110
   期末    123
b  期中     93
   期末      2
dtype: int32
123
期中    110
期末    123
dtype: int32
a  期中    110
   期末    123
b  期中     93
   期末      2
dtype: int32
123
123
a  期末    123
b  期中     93
   期末      2
dtype: int32
                0    1    2    3
python  期 中   123   28  120   69
        期 末     4  146   50   32
math    期 中   142   65   56   81
        期 末    74   59   17   80
En      期 中   133   17   89  113
        期 末    18   35   60  106
python   期 中     123
         期 末       4
math     期 中     142
         期 末      74
En       期 中     133
         期 末      18
Name: 0, dtype: int32
         0    1    2   3
 期 中   123   28  120  69
 期 末     4  146   50  32
                0    1    2   3
python  期 中   123   28  120  69
        期 末     4  146   50  32
math    期 中   142   65   56  81
        期 末    74   59   17  80
0    123
1     28
2    120
3     69
Name: (python,  期 中 ), dtype: int32</code></pre><h2 id="Timestamp"><a href="#Timestamp" class="headerlink" title="Timestamp"></a>Timestamp</h2><h3 id="时间模块datetime"><a href="#时间模块datetime" class="headerlink" title="时间模块datetime"></a>时间模块datetime</h3><h4 id="datetime-date-date对象"><a href="#datetime-date-date对象" class="headerlink" title="datetime.date (date对象)"></a>datetime.date (date对象)</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="comment"># 或者from datetime import date</span></span><br><span class="line">today=datetime.date.today()<span class="comment">#今天的时间</span></span><br><span class="line">print(today,type(today))</span><br><span class="line">print(str(today),type(str(today)))</span><br><span class="line"><span class="comment">#输出date类的格式</span></span><br><span class="line"></span><br><span class="line">print(<span class="string">'-'</span>*<span class="number">30</span>)</span><br><span class="line">t=datetime.date(<span class="number">1997</span>,<span class="number">10</span>,<span class="number">26</span>)</span><br><span class="line">print(t)</span><br><span class="line"><span class="comment">#（年，月，日）</span></span><br></pre></td></tr></table></figure>

<pre><code>2019-11-29 &lt;class &apos;datetime.date&apos;&gt;
2019-11-29 &lt;class &apos;str&apos;&gt;
------------------------------
1997-10-26</code></pre><h4 id="datetime-date-datetime对象"><a href="#datetime-date-datetime对象" class="headerlink" title="datetime.date(datetime对象)"></a>datetime.date(datetime对象)</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">now=datetime.datetime.now()</span><br><span class="line">print(now,type(now))</span><br><span class="line">print(str(now),type(str(now))) </span><br><span class="line"></span><br><span class="line">t1 = datetime.datetime(<span class="number">2016</span>,<span class="number">6</span>,<span class="number">1</span>)</span><br><span class="line">t2 = datetime.datetime(<span class="number">2014</span>,<span class="number">1</span>,<span class="number">1</span>,<span class="number">12</span>,<span class="number">44</span>,<span class="number">33</span>)</span><br><span class="line">print(t1,t2)</span><br><span class="line"><span class="comment"># (年，月，日，时，分，秒)，至少输入年月日</span></span><br><span class="line"></span><br><span class="line">t2-t1</span><br><span class="line"><span class="comment"># 相减得到时间差 —— timedelta</span></span><br></pre></td></tr></table></figure>

<pre><code>2019-11-29 14:47:16.940429 &lt;class &apos;datetime.datetime&apos;&gt;
2019-11-29 14:47:16.940429 &lt;class &apos;str&apos;&gt;
2016-06-01 00:00:00 2014-01-01 12:44:33






datetime.timedelta(-882, 45873)</code></pre><h4 id="datetime-timedelta-时间差"><a href="#datetime-timedelta-时间差" class="headerlink" title="datetime.timedelta(时间差)"></a>datetime.timedelta(时间差)</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">today = datetime.datetime.today()  <span class="comment"># datetime.datetime也有today()方法</span></span><br><span class="line">yestoday = today - datetime.timedelta(<span class="number">1</span>)  <span class="comment"># </span></span><br><span class="line">print(today)</span><br><span class="line">print(yestoday)</span><br><span class="line">print(today - datetime.timedelta(<span class="number">7</span>))</span><br><span class="line"><span class="comment"># 时间差主要用作时间的加减法，相当于可被识别的时间“差值”</span></span><br></pre></td></tr></table></figure>

<pre><code>2019-11-29 14:48:03.943359
2019-11-28 14:48:03.943359
2019-11-22 14:48:03.943359</code></pre><h4 id="parser-parse-日期字符串转换"><a href="#parser-parse-日期字符串转换" class="headerlink" title="parser.parse(日期字符串转换)"></a>parser.parse(日期字符串转换)</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> dateutil.parser <span class="keyword">import</span> parse</span><br><span class="line"></span><br><span class="line">date = <span class="string">'12-21-2017'</span></span><br><span class="line">t = parse(date)</span><br><span class="line">print(t,type(t))</span><br><span class="line"><span class="comment"># 直接将str转化成datetime.datetime</span></span><br><span class="line"></span><br><span class="line">print(parse(<span class="string">'2000-1-1'</span>),<span class="string">'\n'</span>,</span><br><span class="line">     parse(<span class="string">'5/1/2014'</span>),<span class="string">'\n'</span>,</span><br><span class="line">     parse(<span class="string">'5/1/2014'</span>, dayfirst = <span class="literal">True</span>),<span class="string">'\n'</span>,  <span class="comment"># 国际通用格式中，日在月之前，可以通过dayfirst来设置</span></span><br><span class="line">     parse(<span class="string">'22/1/2014'</span>),<span class="string">'\n'</span>,</span><br><span class="line">     parse(<span class="string">'Jan 31, 1997 10:45 PM'</span>))</span><br><span class="line"><span class="comment"># 各种格式可以解析，但无法支持中文</span></span><br></pre></td></tr></table></figure>

<pre><code>2017-12-21 00:00:00 &lt;class &apos;datetime.datetime&apos;&gt;
2000-01-01 00:00:00 
 2014-05-01 00:00:00 
 2014-01-05 00:00:00 
 2014-01-22 00:00:00 
 1997-01-31 22:45:00</code></pre><h3 id="Timestamp-Pandas时刻数据"><a href="#Timestamp-Pandas时刻数据" class="headerlink" title="Timestamp(Pandas时刻数据)"></a>Timestamp(Pandas时刻数据)</h3><p>时刻数据代表时间点，是pandas的数据类型，是将值与时间点相关联的最基本类型的时间序列数据。<strong>pandas.Timestamp()</strong></p>
<h4 id="pd-Timestamp"><a href="#pd-Timestamp" class="headerlink" title="pd.Timestamp()"></a>pd.Timestamp()</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"></span><br><span class="line">date1 = datetime.datetime(<span class="number">2016</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="number">12</span>,<span class="number">45</span>,<span class="number">30</span>)  <span class="comment"># 创建一个datetime.datetime</span></span><br><span class="line">date2 = <span class="string">'2017-12-21'</span>  <span class="comment"># 创建一个字符串</span></span><br><span class="line">t1 = pd.Timestamp(date1)</span><br><span class="line">t2 = pd.Timestamp(date2)</span><br><span class="line">print(t1,type(t1))</span><br><span class="line">print(t2)</span><br><span class="line">print(pd.Timestamp(<span class="string">'2017-12-21 15:00:22'</span>))</span><br><span class="line"><span class="comment"># 直接生成pandas的时刻数据 → 时间戳</span></span><br><span class="line"><span class="comment"># 数据类型为 pandas的Timestamp</span></span><br></pre></td></tr></table></figure>

<pre><code>2016-12-01 12:45:30 &lt;class &apos;pandas._libs.tslibs.timestamps.Timestamp&apos;&gt;
2017-12-21 00:00:00
2017-12-21 15:00:22</code></pre><h4 id="pd-to-datetime（转化为时间戳）"><a href="#pd-to-datetime（转化为时间戳）" class="headerlink" title="pd.to_datetime（转化为时间戳）"></a>pd.to_datetime（转化为时间戳）</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line">date1 = datetime(<span class="number">2016</span>,<span class="number">12</span>,<span class="number">1</span>,<span class="number">12</span>,<span class="number">45</span>,<span class="number">30</span>)</span><br><span class="line">date2 = <span class="string">'2017-12-21'</span></span><br><span class="line">t1 = pd.to_datetime(date1)</span><br><span class="line">t2 = pd.to_datetime(date2)</span><br><span class="line">print(t1,type(t1))</span><br><span class="line">print(t2,type(t2))</span><br><span class="line"><span class="comment"># pd.to_datetime()：如果是单个时间数据，转换成pandas的时刻数据，数据类型为Timestamp</span></span><br><span class="line"></span><br><span class="line">lst_date = [ <span class="string">'2017-12-21'</span>, <span class="string">'2017-12-22'</span>, <span class="string">'2017-12-23'</span>]</span><br><span class="line">t3 = pd.to_datetime(lst_date)</span><br><span class="line">print(t3,type(t3))</span><br><span class="line"><span class="comment"># 多个时间数据，将会转换为pandas的DatetimeIndex</span></span><br></pre></td></tr></table></figure>

<pre><code>2016-12-01 12:45:30 &lt;class &apos;pandas._libs.tslibs.timestamps.Timestamp&apos;&gt;
2017-12-21 00:00:00 &lt;class &apos;pandas._libs.tslibs.timestamps.Timestamp&apos;&gt;
DatetimeIndex([&apos;2017-12-21&apos;, &apos;2017-12-22&apos;, &apos;2017-12-23&apos;], dtype=&apos;datetime64[ns]&apos;, freq=None) &lt;class &apos;pandas.core.indexes.datetimes.DatetimeIndex&apos;&gt;</code></pre><ul>
<li>多个时间数据转换时间戳索引</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">date1 = [datetime(<span class="number">2015</span>,<span class="number">6</span>,<span class="number">1</span>),datetime(<span class="number">2015</span>,<span class="number">7</span>,<span class="number">1</span>),datetime(<span class="number">2015</span>,<span class="number">8</span>,<span class="number">1</span>),datetime(<span class="number">2015</span>,<span class="number">9</span>,<span class="number">1</span>),datetime(<span class="number">2015</span>,<span class="number">10</span>,<span class="number">1</span>)]</span><br><span class="line">date2 = [<span class="string">'2017-2-1'</span>,<span class="string">'2017-2-2'</span>,<span class="string">'2017-2-3'</span>,<span class="string">'2017-2-4'</span>,<span class="string">'2017-2-5'</span>,<span class="string">'2017-2-6'</span>]</span><br><span class="line">print(date1)</span><br><span class="line">print(date2)</span><br><span class="line">t1 = pd.to_datetime(date2)</span><br><span class="line">t2 = pd.to_datetime(date2)</span><br><span class="line">print(t1)</span><br><span class="line">print(t2)</span><br><span class="line"><span class="comment"># 多个时间数据转换为 DatetimeIndex</span></span><br><span class="line"></span><br><span class="line">date3 = [<span class="string">'2017-2-1'</span>,<span class="string">'2017-2-2'</span>,<span class="string">'2017-2-3'</span>,<span class="string">'hello world!'</span>,<span class="string">'2017-2-5'</span>,<span class="string">'2017-2-6'</span>]</span><br><span class="line">t3 = pd.to_datetime(date3, errors = <span class="string">'ignore'</span>)</span><br><span class="line">print(t3,type(t3))</span><br><span class="line"><span class="comment"># 当一组时间序列中夹杂其他格式数据，可用errors参数返回</span></span><br><span class="line"><span class="comment"># errors = 'ignore':不可解析时返回原始输入，这里就是直接生成一般数组</span></span><br><span class="line"></span><br><span class="line">t4 = pd.to_datetime(date3, errors = <span class="string">'coerce'</span>)</span><br><span class="line">print(t4,type(t4))</span><br><span class="line"><span class="comment"># errors = 'coerce':不可扩展，缺失值返回NaT（Not a Time），结果认为DatetimeIndex</span></span><br></pre></td></tr></table></figure>

<pre><code>[datetime.datetime(2015, 6, 1, 0, 0), datetime.datetime(2015, 7, 1, 0, 0), datetime.datetime(2015, 8, 1, 0, 0), datetime.datetime(2015, 9, 1, 0, 0), datetime.datetime(2015, 10, 1, 0, 0)]
[&apos;2017-2-1&apos;, &apos;2017-2-2&apos;, &apos;2017-2-3&apos;, &apos;2017-2-4&apos;, &apos;2017-2-5&apos;, &apos;2017-2-6&apos;]
DatetimeIndex([&apos;2017-02-01&apos;, &apos;2017-02-02&apos;, &apos;2017-02-03&apos;, &apos;2017-02-04&apos;,
               &apos;2017-02-05&apos;, &apos;2017-02-06&apos;],
              dtype=&apos;datetime64[ns]&apos;, freq=None)
DatetimeIndex([&apos;2017-02-01&apos;, &apos;2017-02-02&apos;, &apos;2017-02-03&apos;, &apos;2017-02-04&apos;,
               &apos;2017-02-05&apos;, &apos;2017-02-06&apos;],
              dtype=&apos;datetime64[ns]&apos;, freq=None)
[&apos;2017-2-1&apos; &apos;2017-2-2&apos; &apos;2017-2-3&apos; &apos;hello world!&apos; &apos;2017-2-5&apos; &apos;2017-2-6&apos;] &lt;class &apos;numpy.ndarray&apos;&gt;
DatetimeIndex([&apos;2017-02-01&apos;, &apos;2017-02-02&apos;, &apos;2017-02-03&apos;, &apos;NaT&apos;, &apos;2017-02-05&apos;,
               &apos;2017-02-06&apos;],
              dtype=&apos;datetime64[ns]&apos;, freq=None) &lt;class &apos;pandas.core.indexes.datetimes.DatetimeIndex&apos;&gt;</code></pre><h3 id="DatetimeIndex-Pandas时间戳索引"><a href="#DatetimeIndex-Pandas时间戳索引" class="headerlink" title="DatetimeIndex(Pandas时间戳索引)"></a>DatetimeIndex(Pandas时间戳索引)</h3><h4 id="pd-DatetimeIndex-与TimeSeries时间序列"><a href="#pd-DatetimeIndex-与TimeSeries时间序列" class="headerlink" title="pd.DatetimeIndex()与TimeSeries时间序列"></a>pd.DatetimeIndex()与TimeSeries时间序列</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">rng = pd.DatetimeIndex([<span class="string">'12/1/2017'</span>,<span class="string">'12/2/2017'</span>,<span class="string">'12/3/2017'</span>,<span class="string">'12/4/2017'</span>,<span class="string">'12/5/2017'</span>])</span><br><span class="line">print(rng,type(rng))</span><br><span class="line">print(rng[<span class="number">0</span>],type(rng[<span class="number">0</span>]))</span><br><span class="line"><span class="comment"># 直接生成时间戳索引，支持str、datetime.datetime</span></span><br><span class="line"><span class="comment"># 单个时间戳为Timestamp，多个时间戳为DatetimeIndex</span></span><br><span class="line"></span><br><span class="line">st = pd.Series(np.random.rand(len(rng)), index = rng)</span><br><span class="line">print(st,type(st))</span><br><span class="line">print(st.index)</span><br><span class="line"><span class="comment"># 以DatetimeIndex为index的Series，为TimeSries，时间序列</span></span><br></pre></td></tr></table></figure>

<pre><code>DatetimeIndex([&apos;2017-12-01&apos;, &apos;2017-12-02&apos;, &apos;2017-12-03&apos;, &apos;2017-12-04&apos;,
               &apos;2017-12-05&apos;],
              dtype=&apos;datetime64[ns]&apos;, freq=None) &lt;class &apos;pandas.core.indexes.datetimes.DatetimeIndex&apos;&gt;
2017-12-01 00:00:00 &lt;class &apos;pandas._libs.tslibs.timestamps.Timestamp&apos;&gt;
2017-12-01    0.322258
2017-12-02    0.677879
2017-12-03    0.142017
2017-12-04    0.366208
2017-12-05    0.139923
dtype: float64 &lt;class &apos;pandas.core.series.Series&apos;&gt;
DatetimeIndex([&apos;2017-12-01&apos;, &apos;2017-12-02&apos;, &apos;2017-12-03&apos;, &apos;2017-12-04&apos;,
               &apos;2017-12-05&apos;],
              dtype=&apos;datetime64[ns]&apos;, freq=None)</code></pre><h4 id="pd-date-range-日期范围"><a href="#pd-date-range-日期范围" class="headerlink" title="pd.date_range()-日期范围"></a>pd.date_range()-日期范围</h4><p>生成日期范围</p>
<p>生成方法：</p>
<ul>
<li>start+end</li>
<li>star/end+periods</li>
</ul>
<p>默认频率：day</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">rng1 = pd.date_range(<span class="string">'1/1/2017'</span>,<span class="string">'1/10/2017'</span>, normalize=<span class="literal">True</span>)</span><br><span class="line">rng2 = pd.date_range(start = <span class="string">'1/1/2017'</span>, periods = <span class="number">10</span>)</span><br><span class="line">rng3 = pd.date_range(end = <span class="string">'1/30/2017 15:00:00'</span>, periods = <span class="number">10</span>)  <span class="comment"># 增加了时、分、秒</span></span><br><span class="line">print(rng1,type(rng1))</span><br><span class="line">print(rng2)</span><br><span class="line">print(rng3)</span><br><span class="line">print(<span class="string">'-------'</span>)</span><br><span class="line"><span class="comment"># 直接生成DatetimeIndex</span></span><br><span class="line"><span class="comment"># pd.date_range(start=None, end=None, periods=None, freq='D', tz=None, normalize=False, name=None, closed=None, **kwargs)</span></span><br><span class="line"><span class="comment"># start：开始时间</span></span><br><span class="line"><span class="comment"># end：结束时间</span></span><br><span class="line"><span class="comment"># periods：偏移量</span></span><br><span class="line"><span class="comment"># freq：频率，默认天，pd.date_range()默认频率为日历日，pd.bdate_range()默认频率为工作日</span></span><br><span class="line"><span class="comment"># tz：时区</span></span><br><span class="line"></span><br><span class="line">rng4 = pd.date_range(start = <span class="string">'1/1/2017 15:30'</span>, periods = <span class="number">10</span>, name = <span class="string">'hello world!'</span>, normalize = <span class="literal">True</span>)</span><br><span class="line">print(rng4)</span><br><span class="line">print(<span class="string">'-------'</span>)</span><br><span class="line"><span class="comment"># normalize：时间参数值正则化到午夜时间戳（这里最后就直接变成0:00:00，并不是15:30:00）</span></span><br><span class="line"><span class="comment"># name：索引对象名称</span></span><br><span class="line"></span><br><span class="line">print(pd.date_range(<span class="string">'20170101'</span>,<span class="string">'20170104'</span>))  <span class="comment"># 20170101也可读取</span></span><br><span class="line">print(pd.date_range(<span class="string">'20170101'</span>,<span class="string">'20170104'</span>,closed = <span class="string">'right'</span>))</span><br><span class="line">print(pd.date_range(<span class="string">'20170101'</span>,<span class="string">'20170104'</span>,closed = <span class="string">'left'</span>))</span><br><span class="line">print(<span class="string">'-------'</span>)</span><br><span class="line"><span class="comment"># closed：默认为None的情况下，左闭右闭，left则左闭右开，right则左开右闭</span></span><br><span class="line"></span><br><span class="line">print(pd.bdate_range(<span class="string">'20170101'</span>,<span class="string">'20170107'</span>))</span><br><span class="line"><span class="comment"># pd.bdate_range()默认频率为工作日</span></span><br><span class="line"></span><br><span class="line">print(list(pd.date_range(start = <span class="string">'1/1/2017'</span>, periods = <span class="number">10</span>)))</span><br><span class="line"><span class="comment"># 直接转化为list，元素为Timestamp</span></span><br></pre></td></tr></table></figure>

<pre><code>DatetimeIndex([&apos;2017-01-01&apos;, &apos;2017-01-02&apos;, &apos;2017-01-03&apos;, &apos;2017-01-04&apos;,
               &apos;2017-01-05&apos;, &apos;2017-01-06&apos;, &apos;2017-01-07&apos;, &apos;2017-01-08&apos;,
               &apos;2017-01-09&apos;, &apos;2017-01-10&apos;],
              dtype=&apos;datetime64[ns]&apos;, freq=&apos;D&apos;) &lt;class &apos;pandas.core.indexes.datetimes.DatetimeIndex&apos;&gt;
DatetimeIndex([&apos;2017-01-01&apos;, &apos;2017-01-02&apos;, &apos;2017-01-03&apos;, &apos;2017-01-04&apos;,
               &apos;2017-01-05&apos;, &apos;2017-01-06&apos;, &apos;2017-01-07&apos;, &apos;2017-01-08&apos;,
               &apos;2017-01-09&apos;, &apos;2017-01-10&apos;],
              dtype=&apos;datetime64[ns]&apos;, freq=&apos;D&apos;)
DatetimeIndex([&apos;2017-01-21 15:00:00&apos;, &apos;2017-01-22 15:00:00&apos;,
               &apos;2017-01-23 15:00:00&apos;, &apos;2017-01-24 15:00:00&apos;,
               &apos;2017-01-25 15:00:00&apos;, &apos;2017-01-26 15:00:00&apos;,
               &apos;2017-01-27 15:00:00&apos;, &apos;2017-01-28 15:00:00&apos;,
               &apos;2017-01-29 15:00:00&apos;, &apos;2017-01-30 15:00:00&apos;],
              dtype=&apos;datetime64[ns]&apos;, freq=&apos;D&apos;)
-------
DatetimeIndex([&apos;2017-01-01&apos;, &apos;2017-01-02&apos;, &apos;2017-01-03&apos;, &apos;2017-01-04&apos;,
               &apos;2017-01-05&apos;, &apos;2017-01-06&apos;, &apos;2017-01-07&apos;, &apos;2017-01-08&apos;,
               &apos;2017-01-09&apos;, &apos;2017-01-10&apos;],
              dtype=&apos;datetime64[ns]&apos;, name=&apos;hello world!&apos;, freq=&apos;D&apos;)
-------
DatetimeIndex([&apos;2017-01-01&apos;, &apos;2017-01-02&apos;, &apos;2017-01-03&apos;, &apos;2017-01-04&apos;], dtype=&apos;datetime64[ns]&apos;, freq=&apos;D&apos;)
DatetimeIndex([&apos;2017-01-02&apos;, &apos;2017-01-03&apos;, &apos;2017-01-04&apos;], dtype=&apos;datetime64[ns]&apos;, freq=&apos;D&apos;)
DatetimeIndex([&apos;2017-01-01&apos;, &apos;2017-01-02&apos;, &apos;2017-01-03&apos;], dtype=&apos;datetime64[ns]&apos;, freq=&apos;D&apos;)
-------
DatetimeIndex([&apos;2017-01-02&apos;, &apos;2017-01-03&apos;, &apos;2017-01-04&apos;, &apos;2017-01-05&apos;,
               &apos;2017-01-06&apos;],
              dtype=&apos;datetime64[ns]&apos;, freq=&apos;B&apos;)
[Timestamp(&apos;2017-01-01 00:00:00&apos;, freq=&apos;D&apos;), Timestamp(&apos;2017-01-02 00:00:00&apos;, freq=&apos;D&apos;), Timestamp(&apos;2017-01-03 00:00:00&apos;, freq=&apos;D&apos;), Timestamp(&apos;2017-01-04 00:00:00&apos;, freq=&apos;D&apos;), Timestamp(&apos;2017-01-05 00:00:00&apos;, freq=&apos;D&apos;), Timestamp(&apos;2017-01-06 00:00:00&apos;, freq=&apos;D&apos;), Timestamp(&apos;2017-01-07 00:00:00&apos;, freq=&apos;D&apos;), Timestamp(&apos;2017-01-08 00:00:00&apos;, freq=&apos;D&apos;), Timestamp(&apos;2017-01-09 00:00:00&apos;, freq=&apos;D&apos;), Timestamp(&apos;2017-01-10 00:00:00&apos;, freq=&apos;D&apos;)]</code></pre><h4 id="pd-date-range-日期范围：频率-1"><a href="#pd-date-range-日期范围：频率-1" class="headerlink" title="pd.date_range()-日期范围：频率(1)"></a>pd.date_range()-日期范围：频率(1)</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">print(pd.date_range(<span class="string">'2017/1/1'</span>,<span class="string">'2017/1/4'</span>))  <span class="comment"># 默认freq = 'D'：每日历日</span></span><br><span class="line">print(pd.date_range(<span class="string">'2017/1/1'</span>,<span class="string">'2017/1/4'</span>, freq = <span class="string">'B'</span>))  <span class="comment"># B：每工作日</span></span><br><span class="line">print(pd.date_range(<span class="string">'2017/1/1'</span>,<span class="string">'2017/1/2'</span>, freq = <span class="string">'H'</span>))  <span class="comment"># H：每小时</span></span><br><span class="line">print(pd.date_range(<span class="string">'2017/1/1 12:00'</span>,<span class="string">'2017/1/1 12:10'</span>, freq = <span class="string">'T'</span>))  <span class="comment"># T/MIN：每分</span></span><br><span class="line">print(pd.date_range(<span class="string">'2017/1/1 12:00:00'</span>,<span class="string">'2017/1/1 12:00:10'</span>, freq = <span class="string">'S'</span>))  <span class="comment"># S：每秒</span></span><br><span class="line">print(pd.date_range(<span class="string">'2017/1/1 12:00:00'</span>,<span class="string">'2017/1/1 12:00:10'</span>, freq = <span class="string">'L'</span>))  <span class="comment"># L：每毫秒（千分之一秒）</span></span><br><span class="line">print(pd.date_range(<span class="string">'2017/1/1 12:00:00'</span>,<span class="string">'2017/1/1 12:00:10'</span>, freq = <span class="string">'U'</span>))  <span class="comment"># U：每微秒（百万分之一秒）</span></span><br><span class="line"></span><br><span class="line">print(pd.date_range(<span class="string">'2017/1/1'</span>,<span class="string">'2017/2/1'</span>, freq = <span class="string">'W-MON'</span>))  </span><br><span class="line"><span class="comment"># W-MON：从指定星期几开始算起，每周</span></span><br><span class="line"><span class="comment"># 星期几缩写：MON/TUE/WED/THU/FRI/SAT/SUN</span></span><br><span class="line"></span><br><span class="line">print(pd.date_range(<span class="string">'2017/1/1'</span>,<span class="string">'2017/5/1'</span>, freq = <span class="string">'WOM-2MON'</span>))  </span><br><span class="line"><span class="comment"># WOM-2MON：每月的第几个星期几开始算，这里是每月第二个星期一</span></span><br></pre></td></tr></table></figure>

<pre><code>DatetimeIndex([&apos;2017-01-01&apos;, &apos;2017-01-02&apos;, &apos;2017-01-03&apos;, &apos;2017-01-04&apos;], dtype=&apos;datetime64[ns]&apos;, freq=&apos;D&apos;)
DatetimeIndex([&apos;2017-01-02&apos;, &apos;2017-01-03&apos;, &apos;2017-01-04&apos;], dtype=&apos;datetime64[ns]&apos;, freq=&apos;B&apos;)
DatetimeIndex([&apos;2017-01-01 00:00:00&apos;, &apos;2017-01-01 01:00:00&apos;,
               &apos;2017-01-01 02:00:00&apos;, &apos;2017-01-01 03:00:00&apos;,
               &apos;2017-01-01 04:00:00&apos;, &apos;2017-01-01 05:00:00&apos;,
               &apos;2017-01-01 06:00:00&apos;, &apos;2017-01-01 07:00:00&apos;,
               &apos;2017-01-01 08:00:00&apos;, &apos;2017-01-01 09:00:00&apos;,
               &apos;2017-01-01 10:00:00&apos;, &apos;2017-01-01 11:00:00&apos;,
               &apos;2017-01-01 12:00:00&apos;, &apos;2017-01-01 13:00:00&apos;,
               &apos;2017-01-01 14:00:00&apos;, &apos;2017-01-01 15:00:00&apos;,
               &apos;2017-01-01 16:00:00&apos;, &apos;2017-01-01 17:00:00&apos;,
               &apos;2017-01-01 18:00:00&apos;, &apos;2017-01-01 19:00:00&apos;,
               &apos;2017-01-01 20:00:00&apos;, &apos;2017-01-01 21:00:00&apos;,
               &apos;2017-01-01 22:00:00&apos;, &apos;2017-01-01 23:00:00&apos;,
               &apos;2017-01-02 00:00:00&apos;],
              dtype=&apos;datetime64[ns]&apos;, freq=&apos;H&apos;)
DatetimeIndex([&apos;2017-01-01 12:00:00&apos;, &apos;2017-01-01 12:01:00&apos;,
               &apos;2017-01-01 12:02:00&apos;, &apos;2017-01-01 12:03:00&apos;,
               &apos;2017-01-01 12:04:00&apos;, &apos;2017-01-01 12:05:00&apos;,
               &apos;2017-01-01 12:06:00&apos;, &apos;2017-01-01 12:07:00&apos;,
               &apos;2017-01-01 12:08:00&apos;, &apos;2017-01-01 12:09:00&apos;,
               &apos;2017-01-01 12:10:00&apos;],
              dtype=&apos;datetime64[ns]&apos;, freq=&apos;T&apos;)
DatetimeIndex([&apos;2017-01-01 12:00:00&apos;, &apos;2017-01-01 12:00:01&apos;,
               &apos;2017-01-01 12:00:02&apos;, &apos;2017-01-01 12:00:03&apos;,
               &apos;2017-01-01 12:00:04&apos;, &apos;2017-01-01 12:00:05&apos;,
               &apos;2017-01-01 12:00:06&apos;, &apos;2017-01-01 12:00:07&apos;,
               &apos;2017-01-01 12:00:08&apos;, &apos;2017-01-01 12:00:09&apos;,
               &apos;2017-01-01 12:00:10&apos;],
              dtype=&apos;datetime64[ns]&apos;, freq=&apos;S&apos;)
DatetimeIndex([       &apos;2017-01-01 12:00:00&apos;, &apos;2017-01-01 12:00:00.001000&apos;,
               &apos;2017-01-01 12:00:00.002000&apos;, &apos;2017-01-01 12:00:00.003000&apos;,
               &apos;2017-01-01 12:00:00.004000&apos;, &apos;2017-01-01 12:00:00.005000&apos;,
               &apos;2017-01-01 12:00:00.006000&apos;, &apos;2017-01-01 12:00:00.007000&apos;,
               &apos;2017-01-01 12:00:00.008000&apos;, &apos;2017-01-01 12:00:00.009000&apos;,
               ...
               &apos;2017-01-01 12:00:09.991000&apos;, &apos;2017-01-01 12:00:09.992000&apos;,
               &apos;2017-01-01 12:00:09.993000&apos;, &apos;2017-01-01 12:00:09.994000&apos;,
               &apos;2017-01-01 12:00:09.995000&apos;, &apos;2017-01-01 12:00:09.996000&apos;,
               &apos;2017-01-01 12:00:09.997000&apos;, &apos;2017-01-01 12:00:09.998000&apos;,
               &apos;2017-01-01 12:00:09.999000&apos;,        &apos;2017-01-01 12:00:10&apos;],
              dtype=&apos;datetime64[ns]&apos;, length=10001, freq=&apos;L&apos;)
DatetimeIndex([       &apos;2017-01-01 12:00:00&apos;, &apos;2017-01-01 12:00:00.000001&apos;,
               &apos;2017-01-01 12:00:00.000002&apos;, &apos;2017-01-01 12:00:00.000003&apos;,
               &apos;2017-01-01 12:00:00.000004&apos;, &apos;2017-01-01 12:00:00.000005&apos;,
               &apos;2017-01-01 12:00:00.000006&apos;, &apos;2017-01-01 12:00:00.000007&apos;,
               &apos;2017-01-01 12:00:00.000008&apos;, &apos;2017-01-01 12:00:00.000009&apos;,
               ...
               &apos;2017-01-01 12:00:09.999991&apos;, &apos;2017-01-01 12:00:09.999992&apos;,
               &apos;2017-01-01 12:00:09.999993&apos;, &apos;2017-01-01 12:00:09.999994&apos;,
               &apos;2017-01-01 12:00:09.999995&apos;, &apos;2017-01-01 12:00:09.999996&apos;,
               &apos;2017-01-01 12:00:09.999997&apos;, &apos;2017-01-01 12:00:09.999998&apos;,
               &apos;2017-01-01 12:00:09.999999&apos;,        &apos;2017-01-01 12:00:10&apos;],
              dtype=&apos;datetime64[ns]&apos;, length=10000001, freq=&apos;U&apos;)
DatetimeIndex([&apos;2017-01-02&apos;, &apos;2017-01-09&apos;, &apos;2017-01-16&apos;, &apos;2017-01-23&apos;,
               &apos;2017-01-30&apos;],
              dtype=&apos;datetime64[ns]&apos;, freq=&apos;W-MON&apos;)
DatetimeIndex([&apos;2017-01-09&apos;, &apos;2017-02-13&apos;, &apos;2017-03-13&apos;, &apos;2017-04-10&apos;], dtype=&apos;datetime64[ns]&apos;, freq=&apos;WOM-2MON&apos;)</code></pre><h4 id="pd-date-range-日期范围：频率-2"><a href="#pd-date-range-日期范围：频率-2" class="headerlink" title="pd.date_range()-日期范围：频率(2)"></a>pd.date_range()-日期范围：频率(2)</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">print(pd.date_range(<span class="string">'2017'</span>,<span class="string">'2018'</span>, freq = <span class="string">'M'</span>))  </span><br><span class="line">print(pd.date_range(<span class="string">'2017'</span>,<span class="string">'2020'</span>, freq = <span class="string">'Q-DEC'</span>))  </span><br><span class="line">print(pd.date_range(<span class="string">'2017'</span>,<span class="string">'2020'</span>, freq = <span class="string">'A-DEC'</span>)) </span><br><span class="line">print(<span class="string">'------'</span>)</span><br><span class="line"><span class="comment"># M：每月最后一个日历日</span></span><br><span class="line"><span class="comment"># Q-月：指定月为季度末，每个季度末最后一月的最后一个日历日</span></span><br><span class="line"><span class="comment"># A-月：每年指定月份的最后一个日历日</span></span><br><span class="line"><span class="comment"># 月缩写：JAN/FEB/MAR/APR/MAY/JUN/JUL/AUG/SEP/OCT/NOV/DEC</span></span><br><span class="line"><span class="comment"># 所以Q-月只有三种情况：1-4-7-10,2-5-8-11,3-6-9-12</span></span><br><span class="line"></span><br><span class="line">print(pd.date_range(<span class="string">'2017'</span>,<span class="string">'2018'</span>, freq = <span class="string">'BM'</span>))  </span><br><span class="line">print(pd.date_range(<span class="string">'2017'</span>,<span class="string">'2020'</span>, freq = <span class="string">'BQ-DEC'</span>))  </span><br><span class="line">print(pd.date_range(<span class="string">'2017'</span>,<span class="string">'2020'</span>, freq = <span class="string">'BA-DEC'</span>)) </span><br><span class="line">print(<span class="string">'------'</span>)</span><br><span class="line"><span class="comment"># BM：每月最后一个工作日</span></span><br><span class="line"><span class="comment"># BQ-月：指定月为季度末，每个季度末最后一月的最后一个工作日</span></span><br><span class="line"><span class="comment"># BA-月：每年指定月份的最后一个工作日</span></span><br><span class="line"></span><br><span class="line">print(pd.date_range(<span class="string">'2017'</span>,<span class="string">'2018'</span>, freq = <span class="string">'MS'</span>))  </span><br><span class="line">print(pd.date_range(<span class="string">'2017'</span>,<span class="string">'2020'</span>, freq = <span class="string">'QS-DEC'</span>))  </span><br><span class="line">print(pd.date_range(<span class="string">'2017'</span>,<span class="string">'2020'</span>, freq = <span class="string">'AS-DEC'</span>)) </span><br><span class="line">print(<span class="string">'------'</span>)</span><br><span class="line"><span class="comment"># M：每月第一个日历日</span></span><br><span class="line"><span class="comment"># Q-月：指定月为季度末，每个季度末最后一月的第一个日历日</span></span><br><span class="line"><span class="comment"># A-月：每年指定月份的第一个日历日</span></span><br><span class="line"></span><br><span class="line">print(pd.date_range(<span class="string">'2017'</span>,<span class="string">'2018'</span>, freq = <span class="string">'BMS'</span>))  </span><br><span class="line">print(pd.date_range(<span class="string">'2017'</span>,<span class="string">'2020'</span>, freq = <span class="string">'BQS-DEC'</span>))  </span><br><span class="line">print(pd.date_range(<span class="string">'2017'</span>,<span class="string">'2020'</span>, freq = <span class="string">'BAS-DEC'</span>)) </span><br><span class="line">print(<span class="string">'------'</span>)</span><br><span class="line"><span class="comment"># BM：每月第一个工作日</span></span><br><span class="line"><span class="comment"># BQ-月：指定月为季度末，每个季度末最后一月的第一个工作日</span></span><br><span class="line"><span class="comment"># BA-月：每年指定月份的第一个工作日</span></span><br></pre></td></tr></table></figure>

<pre><code>DatetimeIndex([&apos;2017-01-31&apos;, &apos;2017-02-28&apos;, &apos;2017-03-31&apos;, &apos;2017-04-30&apos;,
               &apos;2017-05-31&apos;, &apos;2017-06-30&apos;, &apos;2017-07-31&apos;, &apos;2017-08-31&apos;,
               &apos;2017-09-30&apos;, &apos;2017-10-31&apos;, &apos;2017-11-30&apos;, &apos;2017-12-31&apos;],
              dtype=&apos;datetime64[ns]&apos;, freq=&apos;M&apos;)
DatetimeIndex([&apos;2017-03-31&apos;, &apos;2017-06-30&apos;, &apos;2017-09-30&apos;, &apos;2017-12-31&apos;,
               &apos;2018-03-31&apos;, &apos;2018-06-30&apos;, &apos;2018-09-30&apos;, &apos;2018-12-31&apos;,
               &apos;2019-03-31&apos;, &apos;2019-06-30&apos;, &apos;2019-09-30&apos;, &apos;2019-12-31&apos;],
              dtype=&apos;datetime64[ns]&apos;, freq=&apos;Q-DEC&apos;)
DatetimeIndex([&apos;2017-12-31&apos;, &apos;2018-12-31&apos;, &apos;2019-12-31&apos;], dtype=&apos;datetime64[ns]&apos;, freq=&apos;A-DEC&apos;)
------
DatetimeIndex([&apos;2017-01-31&apos;, &apos;2017-02-28&apos;, &apos;2017-03-31&apos;, &apos;2017-04-28&apos;,
               &apos;2017-05-31&apos;, &apos;2017-06-30&apos;, &apos;2017-07-31&apos;, &apos;2017-08-31&apos;,
               &apos;2017-09-29&apos;, &apos;2017-10-31&apos;, &apos;2017-11-30&apos;, &apos;2017-12-29&apos;],
              dtype=&apos;datetime64[ns]&apos;, freq=&apos;BM&apos;)
DatetimeIndex([&apos;2017-03-31&apos;, &apos;2017-06-30&apos;, &apos;2017-09-29&apos;, &apos;2017-12-29&apos;,
               &apos;2018-03-30&apos;, &apos;2018-06-29&apos;, &apos;2018-09-28&apos;, &apos;2018-12-31&apos;,
               &apos;2019-03-29&apos;, &apos;2019-06-28&apos;, &apos;2019-09-30&apos;, &apos;2019-12-31&apos;],
              dtype=&apos;datetime64[ns]&apos;, freq=&apos;BQ-DEC&apos;)
DatetimeIndex([&apos;2017-12-29&apos;, &apos;2018-12-31&apos;, &apos;2019-12-31&apos;], dtype=&apos;datetime64[ns]&apos;, freq=&apos;BA-DEC&apos;)
------
DatetimeIndex([&apos;2017-01-01&apos;, &apos;2017-02-01&apos;, &apos;2017-03-01&apos;, &apos;2017-04-01&apos;,
               &apos;2017-05-01&apos;, &apos;2017-06-01&apos;, &apos;2017-07-01&apos;, &apos;2017-08-01&apos;,
               &apos;2017-09-01&apos;, &apos;2017-10-01&apos;, &apos;2017-11-01&apos;, &apos;2017-12-01&apos;,
               &apos;2018-01-01&apos;],
              dtype=&apos;datetime64[ns]&apos;, freq=&apos;MS&apos;)
DatetimeIndex([&apos;2017-03-01&apos;, &apos;2017-06-01&apos;, &apos;2017-09-01&apos;, &apos;2017-12-01&apos;,
               &apos;2018-03-01&apos;, &apos;2018-06-01&apos;, &apos;2018-09-01&apos;, &apos;2018-12-01&apos;,
               &apos;2019-03-01&apos;, &apos;2019-06-01&apos;, &apos;2019-09-01&apos;, &apos;2019-12-01&apos;],
              dtype=&apos;datetime64[ns]&apos;, freq=&apos;QS-DEC&apos;)
DatetimeIndex([&apos;2017-12-01&apos;, &apos;2018-12-01&apos;, &apos;2019-12-01&apos;], dtype=&apos;datetime64[ns]&apos;, freq=&apos;AS-DEC&apos;)
------
DatetimeIndex([&apos;2017-01-02&apos;, &apos;2017-02-01&apos;, &apos;2017-03-01&apos;, &apos;2017-04-03&apos;,
               &apos;2017-05-01&apos;, &apos;2017-06-01&apos;, &apos;2017-07-03&apos;, &apos;2017-08-01&apos;,
               &apos;2017-09-01&apos;, &apos;2017-10-02&apos;, &apos;2017-11-01&apos;, &apos;2017-12-01&apos;,
               &apos;2018-01-01&apos;],
              dtype=&apos;datetime64[ns]&apos;, freq=&apos;BMS&apos;)
DatetimeIndex([&apos;2017-03-01&apos;, &apos;2017-06-01&apos;, &apos;2017-09-01&apos;, &apos;2017-12-01&apos;,
               &apos;2018-03-01&apos;, &apos;2018-06-01&apos;, &apos;2018-09-03&apos;, &apos;2018-12-03&apos;,
               &apos;2019-03-01&apos;, &apos;2019-06-03&apos;, &apos;2019-09-02&apos;, &apos;2019-12-02&apos;],
              dtype=&apos;datetime64[ns]&apos;, freq=&apos;BQS-DEC&apos;)
DatetimeIndex([&apos;2017-12-01&apos;, &apos;2018-12-03&apos;, &apos;2019-12-02&apos;], dtype=&apos;datetime64[ns]&apos;, freq=&apos;BAS-DEC&apos;)
------</code></pre><h4 id="pd-date-range-日期范围：复合频率"><a href="#pd-date-range-日期范围：复合频率" class="headerlink" title="pd.date_range()-日期范围：复合频率"></a>pd.date_range()-日期范围：复合频率</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">print(pd.date_range(<span class="string">'2017/1/1'</span>,<span class="string">'2017/2/1'</span>, freq = <span class="string">'7D'</span>))  <span class="comment"># 7天</span></span><br><span class="line">print(pd.date_range(<span class="string">'2017/1/1'</span>,<span class="string">'2017/1/2'</span>, freq = <span class="string">'2h30min'</span>))  <span class="comment"># 2小时30分钟</span></span><br><span class="line">print(pd.date_range(<span class="string">'2017'</span>,<span class="string">'2018'</span>, freq = <span class="string">'2M'</span>))  <span class="comment"># 2月，每月最后一个日历日</span></span><br></pre></td></tr></table></figure>

<pre><code>DatetimeIndex([&apos;2017-01-01&apos;, &apos;2017-01-08&apos;, &apos;2017-01-15&apos;, &apos;2017-01-22&apos;,
               &apos;2017-01-29&apos;],
              dtype=&apos;datetime64[ns]&apos;, freq=&apos;7D&apos;)
DatetimeIndex([&apos;2017-01-01 00:00:00&apos;, &apos;2017-01-01 02:30:00&apos;,
               &apos;2017-01-01 05:00:00&apos;, &apos;2017-01-01 07:30:00&apos;,
               &apos;2017-01-01 10:00:00&apos;, &apos;2017-01-01 12:30:00&apos;,
               &apos;2017-01-01 15:00:00&apos;, &apos;2017-01-01 17:30:00&apos;,
               &apos;2017-01-01 20:00:00&apos;, &apos;2017-01-01 22:30:00&apos;],
              dtype=&apos;datetime64[ns]&apos;, freq=&apos;150T&apos;)
DatetimeIndex([&apos;2017-01-31&apos;, &apos;2017-03-31&apos;, &apos;2017-05-31&apos;, &apos;2017-07-31&apos;,
               &apos;2017-09-30&apos;, &apos;2017-11-30&apos;],
              dtype=&apos;datetime64[ns]&apos;, freq=&apos;2M&apos;)</code></pre><h4 id="asfreq：时期频率转换"><a href="#asfreq：时期频率转换" class="headerlink" title="asfreq：时期频率转换"></a>asfreq：时期频率转换</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ts = pd.Series(np.random.rand(<span class="number">4</span>),</span><br><span class="line">              index = pd.date_range(<span class="string">'20170101'</span>,<span class="string">'20170104'</span>))</span><br><span class="line">print(ts)</span><br><span class="line">print(ts.asfreq(<span class="string">'4H'</span>,method = <span class="string">'ffill'</span>))</span><br><span class="line"><span class="comment"># 改变频率，这里是D改为4H</span></span><br><span class="line"><span class="comment"># method：插值模式，None不插值，ffill用之前值填充，bfill用之后值填充</span></span><br></pre></td></tr></table></figure>

<pre><code>2017-01-01    0.380807
2017-01-02    0.082508
2017-01-03    0.989844
2017-01-04    0.946656
Freq: D, dtype: float64
2017-01-01 00:00:00    0.380807
2017-01-01 04:00:00    0.380807
2017-01-01 08:00:00    0.380807
2017-01-01 12:00:00    0.380807
2017-01-01 16:00:00    0.380807
2017-01-01 20:00:00    0.380807
2017-01-02 00:00:00    0.082508
2017-01-02 04:00:00    0.082508
2017-01-02 08:00:00    0.082508
2017-01-02 12:00:00    0.082508
2017-01-02 16:00:00    0.082508
2017-01-02 20:00:00    0.082508
2017-01-03 00:00:00    0.989844
2017-01-03 04:00:00    0.989844
2017-01-03 08:00:00    0.989844
2017-01-03 12:00:00    0.989844
2017-01-03 16:00:00    0.989844
2017-01-03 20:00:00    0.989844
2017-01-04 00:00:00    0.946656
Freq: 4H, dtype: float64</code></pre><h4 id="pd-date-range-日期范围：超前-滞后数据"><a href="#pd-date-range-日期范围：超前-滞后数据" class="headerlink" title="pd.date_range()-日期范围：超前/滞后数据"></a>pd.date_range()-日期范围：超前/滞后数据</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">ts = pd.Series(np.random.rand(<span class="number">4</span>),</span><br><span class="line">              index = pd.date_range(<span class="string">'20170101'</span>,<span class="string">'20170104'</span>))</span><br><span class="line">print(ts)</span><br><span class="line"></span><br><span class="line">print(ts.shift(<span class="number">2</span>))</span><br><span class="line">print(ts.shift(<span class="number">-2</span>))</span><br><span class="line">print(<span class="string">'------'</span>)</span><br><span class="line"><span class="comment"># 正数：数值后移（滞后）；负数：数值前移（超前）</span></span><br><span class="line"></span><br><span class="line">per = ts/ts.shift(<span class="number">1</span>) - <span class="number">1</span></span><br><span class="line">print(per)</span><br><span class="line">print(<span class="string">'------'</span>)</span><br><span class="line"><span class="comment"># 计算变化百分比，这里计算：该时间戳与上一个时间戳相比，变化百分比</span></span><br><span class="line"></span><br><span class="line">print(ts.shift(<span class="number">2</span>, freq = <span class="string">'D'</span>))</span><br><span class="line">print(ts.shift(<span class="number">2</span>, freq = <span class="string">'T'</span>))</span><br><span class="line"><span class="comment"># 加上freq参数：对时间戳进行位移，而不是对数值进行位移</span></span><br></pre></td></tr></table></figure>

<pre><code>2017-01-01    0.887591
2017-01-02    0.220969
2017-01-03    0.397006
2017-01-04    0.392343
Freq: D, dtype: float64
2017-01-01         NaN
2017-01-02         NaN
2017-01-03    0.887591
2017-01-04    0.220969
Freq: D, dtype: float64
2017-01-01    0.397006
2017-01-02    0.392343
2017-01-03         NaN
2017-01-04         NaN
Freq: D, dtype: float64
------
2017-01-01         NaN
2017-01-02   -0.751046
2017-01-03    0.796660
2017-01-04   -0.011747
Freq: D, dtype: float64
------
2017-01-03    0.887591
2017-01-04    0.220969
2017-01-05    0.397006
2017-01-06    0.392343
Freq: D, dtype: float64
2017-01-01 00:02:00    0.887591
2017-01-02 00:02:00    0.220969
2017-01-03 00:02:00    0.397006
2017-01-04 00:02:00    0.392343
Freq: D, dtype: float64</code></pre><h3 id="Period（Pandas时期）"><a href="#Period（Pandas时期）" class="headerlink" title="Period（Pandas时期）"></a>Period（Pandas时期）</h3><h4 id="pd-Period-创建时期"><a href="#pd-Period-创建时期" class="headerlink" title="pd.Period()创建时期"></a>pd.Period()创建时期</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">p = pd.Period(<span class="string">'2017'</span>, freq = <span class="string">'M'</span>)</span><br><span class="line">print(p, type(p))</span><br><span class="line"><span class="comment"># 生成一个以2017-01开始，月为频率的时间构造器</span></span><br><span class="line"><span class="comment"># pd.Period()参数：一个时间戳 + freq 参数 → freq 用于指明该 period 的长度，时间戳则说明该 period 在时间轴上的位置</span></span><br><span class="line"></span><br><span class="line">print(p + <span class="number">1</span>)</span><br><span class="line">print(p - <span class="number">2</span>)</span><br><span class="line">print(pd.Period(<span class="string">'2012'</span>, freq = <span class="string">'A-DEC'</span>) - <span class="number">1</span>)</span><br><span class="line"><span class="comment"># 通过加减整数，将周期整体移动</span></span><br><span class="line"><span class="comment"># 这里是按照 月、年 移动</span></span><br></pre></td></tr></table></figure>

<pre><code>2017-01 &lt;class &apos;pandas._libs.tslibs.period.Period&apos;&gt;
2017-02
2016-11
2011</code></pre><h4 id="pd-period-range-创建时期范围"><a href="#pd-period-range-创建时期范围" class="headerlink" title="pd.period_range()创建时期范围"></a>pd.period_range()创建时期范围</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">prng = pd.period_range(<span class="string">'1/1/2011'</span>, <span class="string">'1/1/2012'</span>, freq=<span class="string">'M'</span>)</span><br><span class="line">print(prng,type(prng))</span><br><span class="line">print(prng[<span class="number">0</span>],type(prng[<span class="number">0</span>]))</span><br><span class="line"><span class="comment"># 数据格式为PeriodIndex，单个数值为Period</span></span><br><span class="line"></span><br><span class="line">ts = pd.Series(np.random.rand(len(prng)), index = prng)</span><br><span class="line">print(ts,type(ts))</span><br><span class="line">print(ts.index)</span><br></pre></td></tr></table></figure>

<pre><code>PeriodIndex([&apos;2011-01&apos;, &apos;2011-02&apos;, &apos;2011-03&apos;, &apos;2011-04&apos;, &apos;2011-05&apos;, &apos;2011-06&apos;,
             &apos;2011-07&apos;, &apos;2011-08&apos;, &apos;2011-09&apos;, &apos;2011-10&apos;, &apos;2011-11&apos;, &apos;2011-12&apos;,
             &apos;2012-01&apos;],
            dtype=&apos;period[M]&apos;, freq=&apos;M&apos;) &lt;class &apos;pandas.core.indexes.period.PeriodIndex&apos;&gt;
2011-01 &lt;class &apos;pandas._libs.tslibs.period.Period&apos;&gt;
2011-01    0.824645
2011-02    0.903224
2011-03    0.531356
2011-04    0.232478
2011-05    0.410850
2011-06    0.604149
2011-07    0.680435
2011-08    0.039116
2011-09    0.600320
2011-10    0.503596
2011-11    0.995603
2011-12    0.810485
2012-01    0.985762
Freq: M, dtype: float64 &lt;class &apos;pandas.core.series.Series&apos;&gt;
PeriodIndex([&apos;2011-01&apos;, &apos;2011-02&apos;, &apos;2011-03&apos;, &apos;2011-04&apos;, &apos;2011-05&apos;, &apos;2011-06&apos;,
             &apos;2011-07&apos;, &apos;2011-08&apos;, &apos;2011-09&apos;, &apos;2011-10&apos;, &apos;2011-11&apos;, &apos;2011-12&apos;,
             &apos;2012-01&apos;],
            dtype=&apos;period[M]&apos;, freq=&apos;M&apos;)</code></pre><p><strong>时间序列</strong></p>
<ul>
<li><p>Period(‘2011’, freq = ‘A-DEC’)可以看成多个时间期的时间段中的游标</p>
</li>
<li><p>Timestamp表示一个时间戳，是一个时间截面；Period是一个时期，是一个时间段！！但两者作为index时区别不大</p>
</li>
</ul>
<h4 id="asfreq：频率转换"><a href="#asfreq：频率转换" class="headerlink" title="asfreq：频率转换"></a>asfreq：频率转换</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">p = pd.Period(<span class="string">'2017'</span>,<span class="string">'A-DEC'</span>)</span><br><span class="line">print(p)</span><br><span class="line">print(p.asfreq(<span class="string">'M'</span>, how = <span class="string">'start'</span>))  <span class="comment"># 也可写 how = 's'</span></span><br><span class="line">print(p.asfreq(<span class="string">'D'</span>, how = <span class="string">'end'</span>))  <span class="comment"># 也可写 how = 'e'</span></span><br><span class="line"><span class="comment"># 通过.asfreq(freq, method=None, how=None)方法转换成别的频率</span></span><br><span class="line"></span><br><span class="line">prng = pd.period_range(<span class="string">'2017'</span>,<span class="string">'2018'</span>,freq = <span class="string">'M'</span>)</span><br><span class="line">ts1 = pd.Series(np.random.rand(len(prng)), index = prng)</span><br><span class="line">ts2 = pd.Series(np.random.rand(len(prng)), index = prng.asfreq(<span class="string">'D'</span>, how = <span class="string">'start'</span>))</span><br><span class="line">print(ts1.head(),len(ts1))</span><br><span class="line">print(ts2.head(),len(ts2))</span><br><span class="line"><span class="comment"># asfreq也可以转换TIMESeries的index</span></span><br></pre></td></tr></table></figure>

<pre><code>2017
2017-01
2017-12-31
2017-01    0.803362
2017-02    0.680803
2017-03    0.503056
2017-04    0.885740
2017-05    0.983818
Freq: M, dtype: float64 13
2017-01-01    0.544769
2017-02-01    0.378608
2017-03-01    0.119503
2017-04-01    0.238595
2017-05-01    0.497255
Freq: D, dtype: float64 13</code></pre><h4 id="时间戳与时期之间的转换"><a href="#时间戳与时期之间的转换" class="headerlink" title="时间戳与时期之间的转换"></a>时间戳与时期之间的转换</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">rng = pd.date_range(<span class="string">'2017/1/1'</span>, periods = <span class="number">10</span>, freq = <span class="string">'M'</span>)</span><br><span class="line">prng = pd.period_range(<span class="string">'2017'</span>,<span class="string">'2018'</span>, freq = <span class="string">'M'</span>)</span><br><span class="line"></span><br><span class="line">ts1 = pd.Series(np.random.rand(len(rng)), index = rng)</span><br><span class="line">print(ts1.head())</span><br><span class="line">print(ts1.to_period().head())</span><br><span class="line"><span class="comment"># 每月最后一日，转化为每月</span></span><br><span class="line"></span><br><span class="line">ts2 = pd.Series(np.random.rand(len(prng)), index = prng)</span><br><span class="line">print(ts2.head())</span><br><span class="line">print(ts2.to_timestamp().head())</span><br><span class="line"><span class="comment"># 每月，转化为每月第一天</span></span><br></pre></td></tr></table></figure>

<pre><code>2017-01-31    0.867821
2017-02-28    0.543612
2017-03-31    0.893282
2017-04-30    0.809654
2017-05-31    0.464549
Freq: M, dtype: float64
2017-01    0.867821
2017-02    0.543612
2017-03    0.893282
2017-04    0.809654
2017-05    0.464549
Freq: M, dtype: float64
2017-01    0.731718
2017-02    0.517833
2017-03    0.473853
2017-04    0.009430
2017-05    0.998953
Freq: M, dtype: float64
2017-01-01    0.731718
2017-02-01    0.517833
2017-03-01    0.473853
2017-04-01    0.009430
2017-05-01    0.998953
Freq: MS, dtype: float64</code></pre><h3 id="时间序列-索引及切片"><a href="#时间序列-索引及切片" class="headerlink" title="时间序列 - 索引及切片"></a>时间序列 - 索引及切片</h3><p>TimeSeries是Series的一个子类，所以Series索引及数据选取方面的方法基本一样</p>
<p>同时TimeSeries通过时间序列有更便捷的方法做索引和切片</p>
<h4 id="索引"><a href="#索引" class="headerlink" title="索引"></a>索引</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line">rng = pd.date_range(<span class="string">'2017/1'</span>,<span class="string">'2017/3'</span>)</span><br><span class="line">ts = pd.Series(np.random.rand(len(rng)), index = rng)</span><br><span class="line">print(ts.head())</span><br><span class="line"></span><br><span class="line">print(ts[<span class="number">0</span>])</span><br><span class="line">print(ts[:<span class="number">2</span>])</span><br><span class="line">print(<span class="string">'-----'</span>)</span><br><span class="line"><span class="comment"># 基本下标位置索引</span></span><br><span class="line"></span><br><span class="line">print(ts[<span class="string">'2017/1/2'</span>])</span><br><span class="line">print(ts[<span class="string">'20170103'</span>])</span><br><span class="line">print(ts[<span class="string">'1/10/2017'</span>])</span><br><span class="line">print(ts[datetime(<span class="number">2017</span>,<span class="number">1</span>,<span class="number">20</span>)])</span><br><span class="line">print(<span class="string">'-----'</span>)</span><br><span class="line"><span class="comment"># 时间序列标签索引，支持各种时间字符串，以及datetime.datetime</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 时间序列由于按照时间先后排序，故不用考虑顺序问题</span></span><br><span class="line"><span class="comment"># 索引方法同样适用于Dataframe</span></span><br></pre></td></tr></table></figure>

<pre><code>2017-01-01    0.790453
2017-01-02    0.252198
2017-01-03    0.360769
2017-01-04    0.525272
2017-01-05    0.452863
Freq: D, dtype: float64
0.7904527728537566
2017-01-01    0.790453
2017-01-02    0.252198
Freq: D, dtype: float64
-----
0.25219772923312767
0.3607686710038176
0.6528232574813878
0.352811458536781
-----</code></pre><h4 id="切片"><a href="#切片" class="headerlink" title="切片"></a>切片</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">rng = pd.date_range(<span class="string">'2017/1'</span>,<span class="string">'2017/3'</span>,freq = <span class="string">'12H'</span>)</span><br><span class="line">ts = pd.Series(np.random.rand(len(rng)), index = rng)</span><br><span class="line"></span><br><span class="line">print(ts[<span class="string">'2017/1/5'</span>:<span class="string">'2017/1/10'</span>])</span><br><span class="line">print(<span class="string">'-----'</span>)</span><br><span class="line"><span class="comment"># 和Series按照index索引原理一样，也是末端包含</span></span><br><span class="line"></span><br><span class="line">print(ts[<span class="string">'2017/2'</span>].head())</span><br><span class="line"><span class="comment"># 传入月，直接得到一个切片</span></span><br></pre></td></tr></table></figure>

<pre><code>2017-01-05 00:00:00    0.042829
2017-01-05 12:00:00    0.441050
2017-01-06 00:00:00    0.400631
2017-01-06 12:00:00    0.026122
2017-01-07 00:00:00    0.493281
2017-01-07 12:00:00    0.559460
2017-01-08 00:00:00    0.673397
2017-01-08 12:00:00    0.682465
2017-01-09 00:00:00    0.160642
2017-01-09 12:00:00    0.048712
2017-01-10 00:00:00    0.668822
2017-01-10 12:00:00    0.734941
Freq: 12H, dtype: float64
-----
2017-02-01 00:00:00    0.528840
2017-02-01 12:00:00    0.692276
2017-02-02 00:00:00    0.812610
2017-02-02 12:00:00    0.620347
2017-02-03 00:00:00    0.877217
Freq: 12H, dtype: float64</code></pre><h4 id="重复索引的时间序列"><a href="#重复索引的时间序列" class="headerlink" title="重复索引的时间序列"></a>重复索引的时间序列</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">dates = pd.DatetimeIndex([<span class="string">'1/1/2015'</span>,<span class="string">'1/2/2015'</span>,<span class="string">'1/3/2015'</span>,<span class="string">'1/4/2015'</span>,<span class="string">'1/1/2015'</span>,<span class="string">'1/2/2015'</span>])</span><br><span class="line">ts = pd.Series(np.random.rand(<span class="number">6</span>), index = dates)</span><br><span class="line">print(ts)</span><br><span class="line">print(ts.is_unique,ts.index.is_unique)</span><br><span class="line">print(<span class="string">'-----'</span>)</span><br><span class="line"><span class="comment"># index有重复，is_unique检查 → values唯一，index不唯一</span></span><br><span class="line"></span><br><span class="line">print(ts[<span class="string">'20150101'</span>],type(ts[<span class="string">'20150101'</span>]))</span><br><span class="line">print(ts[<span class="string">'20150104'</span>],type(ts[<span class="string">'20150104'</span>]))</span><br><span class="line">print(<span class="string">'-----'</span>)</span><br><span class="line"><span class="comment"># index有重复的将返回多个值</span></span><br><span class="line"></span><br><span class="line">print(ts.groupby(level = <span class="number">0</span>).mean())</span><br><span class="line"><span class="comment"># 通过groupby做分组，重复的值这里用平均值处理</span></span><br></pre></td></tr></table></figure>

<pre><code>2015-01-01    0.987115
2015-01-02    0.331198
2015-01-03    0.900640
2015-01-04    0.906425
2015-01-01    0.090501
2015-01-02    0.841942
dtype: float64
True False
-----
2015-01-01    0.987115
2015-01-01    0.090501
dtype: float64 &lt;class &apos;pandas.core.series.Series&apos;&gt;
2015-01-04    0.906425
dtype: float64 &lt;class &apos;pandas.core.series.Series&apos;&gt;
-----
2015-01-01    0.538808
2015-01-02    0.586570
2015-01-03    0.900640
2015-01-04    0.906425
dtype: float64</code></pre><h3 id="时间序列-重采样"><a href="#时间序列-重采样" class="headerlink" title="时间序列 - 重采样"></a>时间序列 - 重采样</h3><p>将时间序列从一个频率转换为另一个频率的过程，且会有数据的结合</p>
<ul>
<li><p>降采样：高频数据 → 低频数据，eg.以天为频率的数据转为以月为频率的数据</p>
</li>
<li><p>升采样：低频数据 → 高频数据，eg.以年为频率的数据转为以月为频率的数据</p>
</li>
</ul>
<h4 id="重采样：-resample"><a href="#重采样：-resample" class="headerlink" title="重采样：.resample()"></a>重采样：.resample()</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建一个以天为频率的TimeSeries，重采样为按2天为频率</span></span><br><span class="line"></span><br><span class="line">rng = pd.date_range(<span class="string">'20170101'</span>, periods = <span class="number">12</span>)</span><br><span class="line">ts = pd.Series(np.arange(<span class="number">12</span>), index = rng)</span><br><span class="line">print(ts)</span><br><span class="line"></span><br><span class="line">ts_re = ts.resample(<span class="string">'5D'</span>)</span><br><span class="line">ts_re2 = ts.resample(<span class="string">'5D'</span>).sum()</span><br><span class="line">print(ts_re, type(ts_re))</span><br><span class="line">print(ts_re2, type(ts_re2))</span><br><span class="line">print(<span class="string">'-----'</span>)</span><br><span class="line"><span class="comment"># ts.resample('5D')：得到一个重采样构建器，频率改为5天</span></span><br><span class="line"><span class="comment"># ts.resample('5D').sum():得到一个新的聚合后的Series，聚合方式为求和</span></span><br><span class="line"><span class="comment"># freq：重采样频率 → ts.resample('5D')</span></span><br><span class="line"><span class="comment"># .sum()：聚合方法</span></span><br><span class="line"></span><br><span class="line">print(ts.resample(<span class="string">'5D'</span>).mean(),<span class="string">'→ 求平均值\n'</span>)</span><br><span class="line">print(ts.resample(<span class="string">'5D'</span>).max(),<span class="string">'→ 求最大值\n'</span>)</span><br><span class="line">print(ts.resample(<span class="string">'5D'</span>).min(),<span class="string">'→ 求最小值\n'</span>)</span><br><span class="line">print(ts.resample(<span class="string">'5D'</span>).median(),<span class="string">'→ 求中值\n'</span>)</span><br><span class="line">print(ts.resample(<span class="string">'5D'</span>).first(),<span class="string">'→ 返回第一个值\n'</span>)</span><br><span class="line">print(ts.resample(<span class="string">'5D'</span>).last(),<span class="string">'→ 返回最后一个值\n'</span>)</span><br><span class="line">print(ts.resample(<span class="string">'5D'</span>).ohlc(),<span class="string">'→ OHLC重采样\n'</span>)</span><br><span class="line"><span class="comment"># OHLC:金融领域的时间序列聚合方式 → open开盘、high最大值、low最小值、close收盘</span></span><br></pre></td></tr></table></figure>

<pre><code>2017-01-01     0
2017-01-02     1
2017-01-03     2
2017-01-04     3
2017-01-05     4
2017-01-06     5
2017-01-07     6
2017-01-08     7
2017-01-09     8
2017-01-10     9
2017-01-11    10
2017-01-12    11
Freq: D, dtype: int32
DatetimeIndexResampler [freq=&lt;5 * Days&gt;, axis=0, closed=left, label=left, convention=start, base=0] &lt;class &apos;pandas.core.resample.DatetimeIndexResampler&apos;&gt;
2017-01-01    10
2017-01-06    35
2017-01-11    21
dtype: int32 &lt;class &apos;pandas.core.series.Series&apos;&gt;
-----
2017-01-01     2.0
2017-01-06     7.0
2017-01-11    10.5
dtype: float64 → 求平均值

2017-01-01     4
2017-01-06     9
2017-01-11    11
dtype: int32 → 求最大值

2017-01-01     0
2017-01-06     5
2017-01-11    10
dtype: int32 → 求最小值

2017-01-01     2.0
2017-01-06     7.0
2017-01-11    10.5
dtype: float64 → 求中值

2017-01-01     0
2017-01-06     5
2017-01-11    10
dtype: int32 → 返回第一个值

2017-01-01     4
2017-01-06     9
2017-01-11    11
dtype: int32 → 返回最后一个值

            open  high  low  close
2017-01-01     0     4    0      4
2017-01-06     5     9    5      9
2017-01-11    10    11   10     11 → OHLC重采样</code></pre><p>​    </p>
<h4 id="降采样"><a href="#降采样" class="headerlink" title="降采样"></a>降采样</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">rng = pd.date_range(<span class="string">'20170101'</span>, periods = <span class="number">12</span>)</span><br><span class="line">ts = pd.Series(np.arange(<span class="number">1</span>,<span class="number">13</span>), index = rng)</span><br><span class="line">print(ts)</span><br><span class="line"></span><br><span class="line">print(ts.resample(<span class="string">'5D'</span>).sum(),<span class="string">'→ 默认\n'</span>)</span><br><span class="line">print(ts.resample(<span class="string">'5D'</span>, closed = <span class="string">'left'</span>).sum(),<span class="string">'→ left\n'</span>)</span><br><span class="line">print(ts.resample(<span class="string">'5D'</span>, closed = <span class="string">'right'</span>).sum(),<span class="string">'→ right\n'</span>)</span><br><span class="line">print(<span class="string">'-----'</span>)</span><br><span class="line"><span class="comment"># closed：各时间段哪一端是闭合（即包含）的，默认 左闭右闭</span></span><br><span class="line"><span class="comment"># 详解：这里values为0-11，按照5D重采样 → [1,2,3,4,5],[6,7,8,9,10],[11,12]</span></span><br><span class="line"><span class="comment"># left指定间隔左边为结束 → [1,2,3,4,5],[6,7,8,9,10],[11,12]</span></span><br><span class="line"><span class="comment"># right指定间隔右边为结束 → [1],[2,3,4,5,6],[7,8,9,10,11],[12]</span></span><br><span class="line"></span><br><span class="line">print(ts.resample(<span class="string">'5D'</span>, label = <span class="string">'left'</span>).sum(),<span class="string">'→ leftlabel\n'</span>)</span><br><span class="line">print(ts.resample(<span class="string">'5D'</span>, label = <span class="string">'right'</span>).sum(),<span class="string">'→ rightlabel\n'</span>)</span><br><span class="line"><span class="comment"># label：聚合值的index，默认为取左</span></span><br><span class="line"><span class="comment"># 值采样认为默认（这里closed默认）</span></span><br></pre></td></tr></table></figure>

<pre><code>2017-01-01     1
2017-01-02     2
2017-01-03     3
2017-01-04     4
2017-01-05     5
2017-01-06     6
2017-01-07     7
2017-01-08     8
2017-01-09     9
2017-01-10    10
2017-01-11    11
2017-01-12    12
Freq: D, dtype: int32
2017-01-01    15
2017-01-06    40
2017-01-11    23
dtype: int32 → 默认

2017-01-01    15
2017-01-06    40
2017-01-11    23
dtype: int32 → left

2016-12-27     1
2017-01-01    20
2017-01-06    45
2017-01-11    12
dtype: int32 → right

-----
2017-01-01    15
2017-01-06    40
2017-01-11    23
dtype: int32 → leftlabel

2017-01-06    15
2017-01-11    40
2017-01-16    23
dtype: int32 → rightlabel</code></pre><p>​    </p>
<h4 id="升采样及插值"><a href="#升采样及插值" class="headerlink" title="升采样及插值"></a>升采样及插值</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">rng = pd.date_range(<span class="string">'2017/1/1 0:0:0'</span>, periods = <span class="number">5</span>, freq = <span class="string">'H'</span>)</span><br><span class="line">ts = pd.DataFrame(np.arange(<span class="number">15</span>).reshape(<span class="number">5</span>,<span class="number">3</span>),</span><br><span class="line">                  index = rng,</span><br><span class="line">                  columns = [<span class="string">'a'</span>,<span class="string">'b'</span>,<span class="string">'c'</span>])</span><br><span class="line">print(ts)</span><br><span class="line"></span><br><span class="line">print(ts.resample(<span class="string">'15T'</span>).asfreq())</span><br><span class="line">print(ts.resample(<span class="string">'15T'</span>).ffill())</span><br><span class="line">print(ts.resample(<span class="string">'15T'</span>).bfill())</span><br><span class="line"><span class="comment"># 低频转高频，主要是如何插值</span></span><br><span class="line"><span class="comment"># .asfreq()：不做填充，返回Nan</span></span><br><span class="line"><span class="comment"># .ffill()：向上填充</span></span><br><span class="line"><span class="comment"># .bfill()：向下填充</span></span><br></pre></td></tr></table></figure>

<pre><code>                      a   b   c
2017-01-01 00:00:00   0   1   2
2017-01-01 01:00:00   3   4   5
2017-01-01 02:00:00   6   7   8
2017-01-01 03:00:00   9  10  11
2017-01-01 04:00:00  12  13  14
                        a     b     c
2017-01-01 00:00:00   0.0   1.0   2.0
2017-01-01 00:15:00   NaN   NaN   NaN
2017-01-01 00:30:00   NaN   NaN   NaN
2017-01-01 00:45:00   NaN   NaN   NaN
2017-01-01 01:00:00   3.0   4.0   5.0
2017-01-01 01:15:00   NaN   NaN   NaN
2017-01-01 01:30:00   NaN   NaN   NaN
2017-01-01 01:45:00   NaN   NaN   NaN
2017-01-01 02:00:00   6.0   7.0   8.0
2017-01-01 02:15:00   NaN   NaN   NaN
2017-01-01 02:30:00   NaN   NaN   NaN
2017-01-01 02:45:00   NaN   NaN   NaN
2017-01-01 03:00:00   9.0  10.0  11.0
2017-01-01 03:15:00   NaN   NaN   NaN
2017-01-01 03:30:00   NaN   NaN   NaN
2017-01-01 03:45:00   NaN   NaN   NaN
2017-01-01 04:00:00  12.0  13.0  14.0
                      a   b   c
2017-01-01 00:00:00   0   1   2
2017-01-01 00:15:00   0   1   2
2017-01-01 00:30:00   0   1   2
2017-01-01 00:45:00   0   1   2
2017-01-01 01:00:00   3   4   5
2017-01-01 01:15:00   3   4   5
2017-01-01 01:30:00   3   4   5
2017-01-01 01:45:00   3   4   5
2017-01-01 02:00:00   6   7   8
2017-01-01 02:15:00   6   7   8
2017-01-01 02:30:00   6   7   8
2017-01-01 02:45:00   6   7   8
2017-01-01 03:00:00   9  10  11
2017-01-01 03:15:00   9  10  11
2017-01-01 03:30:00   9  10  11
2017-01-01 03:45:00   9  10  11
2017-01-01 04:00:00  12  13  14
                      a   b   c
2017-01-01 00:00:00   0   1   2
2017-01-01 00:15:00   3   4   5
2017-01-01 00:30:00   3   4   5
2017-01-01 00:45:00   3   4   5
2017-01-01 01:00:00   3   4   5
2017-01-01 01:15:00   6   7   8
2017-01-01 01:30:00   6   7   8
2017-01-01 01:45:00   6   7   8
2017-01-01 02:00:00   6   7   8
2017-01-01 02:15:00   9  10  11
2017-01-01 02:30:00   9  10  11
2017-01-01 02:45:00   9  10  11
2017-01-01 03:00:00   9  10  11
2017-01-01 03:15:00  12  13  14
2017-01-01 03:30:00  12  13  14
2017-01-01 03:45:00  12  13  14
2017-01-01 04:00:00  12  13  14</code></pre><h4 id="时期重采样-Period"><a href="#时期重采样-Period" class="headerlink" title="时期重采样 - Period"></a>时期重采样 - Period</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">prng = pd.period_range(<span class="string">'2016'</span>,<span class="string">'2017'</span>,freq = <span class="string">'M'</span>)</span><br><span class="line">ts = pd.Series(np.arange(len(prng)), index = prng)</span><br><span class="line">print(ts)</span><br><span class="line"></span><br><span class="line"><span class="comment">#print(ts.resample('3M').sum())  </span></span><br><span class="line"><span class="comment"># 降采样</span></span><br><span class="line">print(ts.resample(<span class="string">'15D'</span>).ffill())  <span class="comment"># 升采样</span></span><br></pre></td></tr></table></figure>

<pre><code>2016-01     0
2016-02     1
2016-03     2
2016-04     3
2016-05     4
2016-06     5
2016-07     6
2016-08     7
2016-09     8
2016-10     9
2016-11    10
2016-12    11
2017-01    12
Freq: M, dtype: int32
2016-01-01     0
2016-01-16     0
2016-01-31     0
2016-02-15     1
2016-03-01     2
2016-03-16     2
2016-03-31     2
2016-04-15     3
2016-04-30     3
2016-05-15     4
2016-05-30     4
2016-06-14     5
2016-06-29     5
2016-07-14     6
2016-07-29     6
2016-08-13     7
2016-08-28     7
2016-09-12     8
2016-09-27     8
2016-10-12     9
2016-10-27     9
2016-11-11    10
2016-11-26    10
2016-12-11    11
2016-12-26    11
2017-01-10    12
2017-01-25    12
Freq: 15D, dtype: int3gou</code></pre>
      
      <!-- 打赏 -->
      
      <div id="reward-btn">
        打赏
      </div>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://ryanhuo.github.io/2020/01/20/3.%20pandas/" data-id="ck5m8erv900381cfz5wtx8kag"
        class="article-share-link">分享</a>
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python%E5%BA%93/" rel="tag">python库</a></li></ul>

    </footer>

  </div>

  
  
  <nav class="article-nav">
    
      <a href="/2020/01/20/2.%20numpy/" class="article-nav-link">
        <strong class="article-nav-caption">上一篇</strong>
        <div class="article-nav-title">
          
            2. numpy
          
        </div>
      </a>
    
    
      <a href="/2020/01/20/1.%20matplotlib/" class="article-nav-link">
        <strong class="article-nav-caption">下一篇</strong>
        <div class="article-nav-title">1. matplotlib</div>
      </a>
    
  </nav>


  

  
  
<!-- valine评论 -->
<div id="vcomments-box">
    <div id="vcomments">
    </div>
</div>
<script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
<script src='https://cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js'></script>
<script>
    new Valine({
        el: '#vcomments',
        notify: false,
        verify: false,
        app_id: '',
        app_key: '',
        path: window.location.pathname,
        avatar: 'mp',
        placeholder: '给我的文章加点评论吧~',
        recordIP: true
    });
    const infoEle = document.querySelector('#vcomments .info');
    if (infoEle && infoEle.childNodes && infoEle.childNodes.length > 0) {
        infoEle.childNodes.forEach(function (item) {
            item.parentNode.removeChild(item);
        });
    }
</script>
<style>
    #vcomments-box {
        padding: 5px 30px;
    }

    @media screen and (max-width: 800px) {
        #vcomments-box {
            padding: 5px 0px;
        }
    }

    #vcomments-box #vcomments {
        background-color: #fff;
    }

    .v .vlist .vcard .vh {
        padding-right: 20px;
    }

    .v .vlist .vcard {
        padding-left: 10px;
    }
</style>

  

  
  
  

</article>
</section>
      <footer class="footer">
  <div class="outer">
    <ul class="list-inline">
      <li>
        &copy;
        2020
        Ryan
      </li>
      <li>
        
          Powered by
        
        
        <a href="https://hexo.io" target="_blank">Hexo</a> Theme <a href="https://github.com/Shen-Yu/hexo-theme-ayer" target="_blank">Ayer</a>
        
      </li>
    </ul>
    <ul class="list-inline">
      <li>
        
        
        <ul class="list-inline">
  <li>PV:<span id="busuanzi_value_page_pv"></span></li>
  <li>UV:<span id="busuanzi_value_site_uv"></span></li>
</ul>
        
      </li>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>
    <div class="to_top">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>
      </div>
    </main>
    
    <aside class="sidebar">
      
        <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">目录</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories/%E5%85%B6%E4%BB%96">其他</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories/data-analytics">DA</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
      </aside>
      <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/images/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
      
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/jquery.justifiedGallery.min.js"></script>


<script src="/js/lazyload.min.js"></script>


<script src="/js/busuanzi-2.3.pure.min.js"></script>


  
<script src="/fancybox/jquery.fancybox.min.js"></script>




  
<script src="/js/tocbot.min.js"></script>

  <script>
    // Tocbot_v4.7.0  http://tscanlin.github.io/tocbot/
    tocbot.init({
      tocSelector: '.tocbot',
      contentSelector: '.article-entry',
      headingSelector: 'h1, h2, h3, h4, h5, h6',
      hasInnerContainers: true,
      scrollSmooth: true,
      positionFixedSelector: '.tocbot',
      positionFixedClass: 'is-position-fixed',
      fixedSidebarOffset: 'auto',
			onClick: (e) => {
      	document.getElementById(e.target.innerText).scrollIntoView()
      	return false;
    	}
    });
  </script>


<script>
  var ayerConfig = {
    mathjax: true
  }
</script>


<script src="/js/ayer.js"></script>


<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">


  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
  });

  MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for(i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.6/unpacked/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


<script type="text/javascript" src="https://js.users.51.la/20544303.js"></script>
  
  

  </div>
</body>

</html>